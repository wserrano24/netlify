{"version":3,"file":"FormUtil.js","sources":["../../../../../../../../../../../packages/@okta/courage-dist/esm/src/courage/views/forms/helpers/FormUtil.js"],"sourcesContent":["import oktaUnderscore from '../../../util/underscore-wrapper.js';\nimport Keys from '../../../util/Keys.js';\nimport Logger from '../../../util/Logger.js';\nimport StringUtil from '../../../util/StringUtil.js';\nimport ViewUtil from '../../../util/ViewUtil.js';\nimport BaseView from '../../BaseView.js';\n\n/* eslint max-params: [2, 6] */\nconst LABEL_OPTIONS = ['model', 'id', 'inputId', 'type', 'label', 'sublabel', 'tooltip', 'name', 'group'];\nconst CONTAINER_OPTIONS = ['wide', 'multi', 'input', 'label-top', 'explain', 'explain-top', 'customExplain', 'model', 'name', 'type', 'autoRender', 'multirowError'];\nconst WRAPPER_OPTIONS = ['model', 'name', 'label-top', 'readOnly', 'events', 'initialize', 'showWhen', 'bindings', 'render', 'className', 'data-se', 'toggleWhen', 'group'];\nconst INPUT_OPTIONS = ['model', 'name', 'inputId', 'type', // base options\n'input', // custom input\n'placeholder', 'label', // labels\n'readOnly', 'read', 'disabled', 'readModeString', // modes\n'options', // select/radio\n'deps', // used to specify inputs that have dependencies and show a callout to user on select\n'from', 'to', // model transformers,\n'autoRender', // model attributes change event to trigger rerendering of the input\n'inlineValidation', // control inline validating against the model on focus lost\n'validateOnlyIfDirty', // check if field has been interacted with and then validate\n'ariaLabel', // 508 compliance for inputs that do not have label associated with them\n'params', 'autoComplete', // autocomplete attribute\n'sortByKey'];\nconst OTHER_OPTIONS = ['errorField' // widgets params - for input specific widgets\n];\n\nconst ALL_OPTIONS = oktaUnderscore.uniq(oktaUnderscore.union(LABEL_OPTIONS, CONTAINER_OPTIONS, WRAPPER_OPTIONS, INPUT_OPTIONS, OTHER_OPTIONS));\n\nconst SAVE_BUTTON_PHASES = ['•         ', '•  •      ', '•  •  •   ', '•  •  •  •', '   •  •  •', '      •  •', '         •', '          ', '          ', '          '];\n\nfunction decorateDoWhen(doWhen) {\n  if (doWhen && !doWhen['__edit__']) {\n    return oktaUnderscore.extend({\n      __edit__: oktaUnderscore.constant(true)\n    }, doWhen);\n  }\n}\n\nfunction createButton(options) {\n  options = oktaUnderscore.pick(options || {}, 'action', 'id', 'className', 'text', 'type');\n  let timeoutId;\n  let intervalId;\n  let phaseCount;\n  return BaseView.extend({\n    tagName: 'input',\n    className: 'button',\n    events: {\n      click: function () {\n        if (options.action && !this.disabled()) {\n          options.action.call(this);\n        }\n      },\n      keyup: function (e) {\n        if (Keys.isEnter(e) && options.action && !this.disabled()) {\n          options.action.call(this);\n        }\n      }\n    },\n    disabled: function () {\n      return this.$el.prop('disabled') === true;\n    },\n    disable: function () {\n      this.$el.prop('disabled', true);\n      this.$el.addClass('btn-disabled');\n    },\n    enable: function () {\n      this.$el.prop('disabled', false);\n      this.$el.removeClass('btn-disabled');\n    },\n    initialize: function () {\n      const self = this;\n      this.$el.attr('type', options.type === 'save' ? 'submit' : 'button');\n      this.$el.val(options.text);\n\n      if (options.id) {\n        this.$el.attr('id', options.id);\n      }\n\n      if (options.className) {\n        this.$el.addClass(options.className);\n      }\n\n      if (options.type) {\n        this.$el.attr('data-type', options.type);\n      }\n\n      this.$el.mousedown(function () {\n        self.model.set('__pending__', true);\n      });\n      this.$el.mouseup(function () {\n        self.model.set('__pending__', false);\n      });\n      this.listenTo(this.model, 'form:set-saving-state', function () {\n        this.disable();\n\n        if (options.type === 'save') {\n          timeoutId = setTimeout(oktaUnderscore.bind(this.__changeSaveText, this), 1000);\n        }\n      });\n      this.listenTo(this.model, 'form:clear-saving-state', function () {\n        this.enable();\n\n        if (options.type === 'save') {\n          clearTimeout(timeoutId);\n          clearInterval(intervalId);\n          this.$el.val(options.text);\n        }\n      });\n    },\n    __changeSaveText: function () {\n      phaseCount = 0;\n      intervalId = setInterval(oktaUnderscore.bind(this.__showLoadingText, this), 200);\n    },\n    __showLoadingText: function () {\n      this.$el.val(SAVE_BUTTON_PHASES[phaseCount++ % SAVE_BUTTON_PHASES.length]);\n    }\n  });\n}\n\nfunction validateInput(options, model) {\n  /* eslint max-statements: 0, complexity: 0 */\n  options || (options = {});\n\n  if (options.type === 'label') {\n    if (!options.label) {\n      Logger.warn('A label input must have a \"label\" parameter', options);\n    }\n\n    return;\n  }\n\n  if (options.type === 'button') {\n    if (!options.title && !options.icon) {\n      Logger.warn('A button input must have a \"title\" and/or an \"icon\" parameter', options);\n    }\n\n    if (!options.click && !options.href) {\n      Logger.warn('A button input must have a \"click\" and/or an \"href\" parameter', options);\n    }\n\n    return;\n  }\n\n  if (!options.name && !options.input) {\n    Logger.warn('Missing \"name\" or \"input\" parameters', options);\n  }\n\n  if (oktaUnderscore.isArray(options.name) && oktaUnderscore.isArray(options.input)) {\n    throw new Error('Not allowed to have both \"name\" and \"input\" defined as array.');\n  }\n\n  if (options.type !== 'list' && options.name && model && model.allows) {\n    let names = [];\n\n    if (oktaUnderscore.isArray(options.name)) {\n      names = options.name;\n    } else {\n      names.push(options.name);\n    }\n\n    oktaUnderscore.each(names, function (name) {\n      if (!model.allows(name)) {\n        throw new Error('field not allowed: ' + options.name);\n      }\n    });\n  }\n\n  if (oktaUnderscore.isArray(options.input) && options.type !== 'list') {\n    oktaUnderscore.each(options.input, function (input) {\n      validateInput(input, model);\n    });\n  }\n\n  const keys = oktaUnderscore.keys(options);\n\n  const intersection = oktaUnderscore.intersection(keys, ALL_OPTIONS);\n\n  if (oktaUnderscore.size(intersection) !== oktaUnderscore.size(options)) {\n    const fields = oktaUnderscore.clone(ALL_OPTIONS);\n\n    Logger.warn('Invalid input parameters', oktaUnderscore.without(keys, ...fields), options);\n  }\n}\n\nfunction generateInputOptions(options, form, createFn) {\n  options = oktaUnderscore.clone(options);\n\n  if (oktaUnderscore.contains(['list', 'group'], options.type)) {\n    options.params = oktaUnderscore.defaults({\n      create: createFn,\n      inputs: oktaUnderscore.map(oktaUnderscore.isArray(options.input) ? options.input : [options.input], function (input) {\n        return oktaUnderscore.first(generateInputOptions(input, form, createFn));\n      })\n    }, options.params || {});\n    delete options.input;\n  }\n\n  const inputs = oktaUnderscore.isArray(options.input) ? oktaUnderscore.clone(options.input) : [options];\n  return oktaUnderscore.map(inputs, function (input) {\n    const target = oktaUnderscore.defaults({\n      model: form.model\n    }, input, oktaUnderscore.omit(options, 'input', 'inputs'), form.options, {\n      id: oktaUnderscore.uniqueId('input'),\n      readOnly: form.isReadOnly(),\n      read: form.hasReadMode()\n    });\n\n    if (form.isReadOnly()) {\n      target.read = target.readOnly = true;\n    }\n\n    return target;\n  });\n}\n\nvar FormUtil = {\n  LABEL_OPTIONS: LABEL_OPTIONS,\n  CONTAINER_OPTIONS: CONTAINER_OPTIONS,\n  WRAPPER_OPTIONS: WRAPPER_OPTIONS,\n  INPUT_OPTIONS: INPUT_OPTIONS,\n  generateInputOptions: generateInputOptions,\n  changeEventString: function (fieldNames) {\n    return 'change:' + fieldNames.join(' change:');\n  },\n  createReadFormButton: function (options) {\n    let action;\n    let text;\n    let ariaLabel;\n\n    if (options.type === 'cancel') {\n      text = ariaLabel = StringUtil.localize('oform.cancel', 'courage');\n\n      action = function () {\n        this.model.trigger('form:cancel');\n      };\n    } else {\n      text = StringUtil.localize('oform.edit', 'courage');\n      ariaLabel = text + ' ' + options.formTitle;\n\n      action = function () {\n        this.model.set('__edit__', true);\n      };\n    }\n\n    return BaseView.extend({\n      tagName: 'a',\n      className: options.className,\n      attributes: {\n        href: '#',\n        'aria-label': ariaLabel\n      },\n      // TODO: refactor to enforce precompiled templates OKTA-309852\n      // eslint-disable-next-line @okta/okta-ui/no-bare-templates\n      template: function () {\n        return oktaUnderscore.escape(text);\n      },\n      events: {\n        click: function (e) {\n          e.preventDefault();\n          action.call(this);\n        }\n      }\n    });\n  },\n  createButton: function (options) {\n    options = oktaUnderscore.clone(options);\n\n    switch (options.type) {\n      case 'save':\n        oktaUnderscore.defaults(options, {\n          className: 'button-primary'\n        });\n\n        break;\n\n      case 'cancel':\n        oktaUnderscore.defaults(options, {\n          className: 'button-clear',\n          text: StringUtil.localize('oform.cancel', 'courage'),\n          action: function () {\n            this.model.trigger('form:cancel');\n          }\n        });\n\n        break;\n\n      case 'previous':\n        oktaUnderscore.defaults(options, {\n          text: StringUtil.localize('oform.previous', 'courage'),\n          action: function () {\n            this.model.trigger('form:previous');\n          }\n        });\n\n        break;\n    }\n\n    return createButton(options);\n  },\n  validateInput: validateInput,\n\n  /**\n   * Applies a show-when logic on a view instance.\n   * The show-when is a map of a model field name -> a boolean or a function that returns a boolean.\n   * The view will toggle based on the field value.\n   *\n   * @param  {Okta.View} view a view instance that has a this.model attached to it\n   * @param  {Object} showWhen\n   */\n  applyShowWhen: function (view, showWhen) {\n    const toggleAndResize = function (bool) {\n      return function () {\n        // The `toggle` is here since an event may be triggered before the el is in the DOM\n        // and in that case slide events may not function as expected.\n        view.$el.toggle(bool);\n        view.model.trigger('form:resize');\n      };\n    };\n\n    ViewUtil.applyDoWhen(view, decorateDoWhen(showWhen), function (bool, options) {\n      if (!options.animate) {\n        view.$el.toggle(bool);\n      } else {\n        view.$el['slide' + (bool ? 'Down' : 'Up')](200, toggleAndResize(bool));\n      }\n    });\n  },\n  applyToggleWhen: function (view, toggleWhen) {\n    ViewUtil.applyDoWhen(view, decorateDoWhen(toggleWhen), function (bool, options) {\n      view.$el.toggle(bool);\n      view.model.trigger('form:resize');\n\n      if (options.animate) {\n        view.render();\n      }\n    });\n  }\n};\n\nexport { FormUtil as default };\n"],"names":["LABEL_OPTIONS","CONTAINER_OPTIONS","WRAPPER_OPTIONS","INPUT_OPTIONS","OTHER_OPTIONS","ALL_OPTIONS","oktaUnderscore","uniq","union","SAVE_BUTTON_PHASES","decorateDoWhen","doWhen","extend","__edit__","constant","createButton","options","pick","timeoutId","intervalId","phaseCount","BaseView","tagName","className","events","click","action","disabled","call","keyup","e","Keys","isEnter","$el","prop","disable","addClass","enable","removeClass","initialize","self","attr","type","val","text","id","mousedown","model","set","mouseup","listenTo","setTimeout","bind","__changeSaveText","clearTimeout","clearInterval","setInterval","__showLoadingText","length","validateInput","label","title","icon","href","name","input","isArray","Error","allows","names","push","each","keys","intersection","size","clone","generateInputOptions","form","createFn","contains","params","defaults","create","inputs","map","first","target","omit","uniqueId","readOnly","isReadOnly","read","hasReadMode","FormUtil","changeEventString","fieldNames","join","createReadFormButton","ariaLabel","StringUtil","localize","trigger","formTitle","attributes","template","escape","preventDefault","applyShowWhen","view","showWhen","toggleAndResize","bool","toggle","ViewUtil","applyDoWhen","animate","applyToggleWhen","toggleWhen","render"],"mappings":"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"}
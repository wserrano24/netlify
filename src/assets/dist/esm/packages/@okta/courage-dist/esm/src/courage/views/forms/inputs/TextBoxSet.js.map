{"version":3,"file":"TextBoxSet.js","sources":["../../../../../../../../../../../packages/@okta/courage-dist/esm/src/courage/views/forms/inputs/TextBoxSet.js"],"sourcesContent":["import _Handlebars2 from '../../../../../lib/handlebars/dist/cjs/handlebars.runtime.js';\nimport oktaUnderscore from '../../../util/underscore-wrapper.js';\nimport SchemaUtils from '../../../util/SchemaUtil.js';\nimport BaseInput from '../BaseInput.js';\nimport DeletableBox from './DeletableBox.js';\n\nvar TextBoxSet = BaseInput.extend({\n  className: 'array-input',\n  template: _Handlebars2.template({\n    \"compiler\": [8, \">= 4.3.0\"],\n    \"main\": function (container, depth0, helpers, partials, data) {\n      var lookupProperty = container.lookupProperty || function (parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n\n        return undefined;\n      };\n\n      return \"<a href=\\\"#\\\" class=\\\"array-inputs-button link-button\\\">\" + container.escapeExpression((lookupProperty(helpers, \"i18n\") || depth0 && lookupProperty(depth0, \"i18n\") || container.hooks.helperMissing).call(depth0 != null ? depth0 : container.nullContext || {}, {\n        \"name\": \"i18n\",\n        \"hash\": {\n          \"bundle\": \"courage\",\n          \"code\": \"oform.add.another\"\n        },\n        \"data\": data,\n        \"loc\": {\n          \"start\": {\n            \"line\": 1,\n            \"column\": 52\n          },\n          \"end\": {\n            \"line\": 1,\n            \"column\": 102\n          }\n        }\n      })) + \"</a>\";\n    },\n    \"useData\": true\n  }),\n  params: {\n    itemType: 'string'\n  },\n  events: {\n    'click .array-inputs-button': function (e) {\n      e.preventDefault();\n\n      if (this.isEditMode()) {\n        this.addNewElement();\n      }\n    }\n  },\n  initialize: function (options) {\n    options || (options = {});\n    this.params = oktaUnderscore.defaults(options.params || {}, this.params);\n    this.uniqueIdPrefix = 'array';\n  },\n  // api returns null for an array that does not have value\n  // convert it to an empty array\n  from: function (val) {\n    if (!oktaUnderscore.isArray(val)) {\n      return [];\n    }\n\n    return val;\n  },\n  // @Override\n  editMode: function () {\n    this._setArrayObject();\n\n    this.$el.html(this.template);\n\n    oktaUnderscore.each(this.arrayObject, oktaUnderscore.bind(this._addDeletableBox, this));\n\n    return this;\n  },\n  // @Override\n  readMode: function () {\n    this.editMode();\n    this.$('.array-inputs-button').addClass('link-button-disabled');\n  },\n  // @Override\n  // converts arrayObject to a plain array\n  // for string type array, returns all values\n  // for number/integer type array, returns values in number type\n  val: function () {\n    let values = oktaUnderscore.values(this.arrayObject);\n\n    if (oktaUnderscore.contains([SchemaUtils.DATATYPE.number, SchemaUtils.DATATYPE.integer], this.params.itemType)) {\n      values = oktaUnderscore.filter(values, oktaUnderscore.isNumber);\n    }\n\n    return values;\n  },\n  focus: function () {},\n  addNewElement: function () {\n    const value = '';\n\n    const key = oktaUnderscore.uniqueId(this.uniqueIdPrefix);\n\n    this.arrayObject[key] = value;\n\n    this._addDeletableBox(value, key); // update is called to make sure an empty string value is added for string type array\n\n\n    this.update();\n  },\n  _addDeletableBox: function (value, key) {\n    const deletableBox = new DeletableBox(oktaUnderscore.extend(oktaUnderscore.pick(this.options, 'read', 'readOnly', 'model'), {\n      key: key,\n      value: value,\n      itemType: this.params.itemType\n    }));\n    this.listenTo(deletableBox, 'updateArray', function (updatedValue) {\n      if (oktaUnderscore.isNull(updatedValue)) {\n        delete this.arrayObject[key];\n        this.stopListening(deletableBox);\n      } else {\n        this.arrayObject[key] = updatedValue;\n      }\n\n      this.update();\n    });\n    deletableBox.render().$el.hide();\n    this.$('.array-inputs-button').before(deletableBox.el);\n    deletableBox.$el.slideDown();\n    return deletableBox;\n  },\n  _setArrayObject: function () {\n    const array = this.model.get(this.options.name);\n    this.arrayObject = {};\n\n    if (oktaUnderscore.isArray(array) && !oktaUnderscore.isEmpty(array)) {\n      const keys = [];\n      const self = this;\n\n      oktaUnderscore(array.length).times(function () {\n        keys.push(oktaUnderscore.uniqueId(self.uniqueIdPrefix));\n      });\n\n      this.arrayObject = oktaUnderscore.object(keys, array);\n    }\n  }\n});\n\nexport { TextBoxSet as default };\n"],"names":["TextBoxSet","BaseInput","extend","className","template","_Handlebars2","container","depth0","helpers","partials","data","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","undefined","escapeExpression","hooks","helperMissing","nullContext","params","itemType","events","e","preventDefault","isEditMode","addNewElement","initialize","options","oktaUnderscore","defaults","uniqueIdPrefix","from","val","isArray","editMode","_setArrayObject","$el","html","each","arrayObject","bind","_addDeletableBox","readMode","$","addClass","values","contains","SchemaUtils","DATATYPE","number","integer","filter","isNumber","focus","value","key","uniqueId","update","deletableBox","DeletableBox","pick","listenTo","updatedValue","isNull","stopListening","render","hide","before","el","slideDown","array","model","get","name","isEmpty","keys","self","length","times","push","object"],"mappings":"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"}
{"version":3,"file":"proto-access.js","sources":["../../../../../../../../../../../../packages/@okta/courage-dist/esm/lib/handlebars/dist/cjs/handlebars/internal/proto-access.js"],"sourcesContent":["import { __exports as protoAccess } from '../../../../../../_virtual/proto-access.js';\nexport { __exports as default } from '../../../../../../_virtual/proto-access.js';\nimport './create-new-lookup-object.js';\nimport '../logger.js';\nimport { __exports as createNewLookupObject } from '../../../../../../_virtual/create-new-lookup-object.js';\nimport { l as logger$1 } from '../../../../../../_virtual/logger.js';\n\nprotoAccess.__esModule = true;\nprotoAccess.createProtoAccessControl = createProtoAccessControl;\nprotoAccess.resultIsAllowed = resultIsAllowed;\nprotoAccess.resetLoggedProperties = resetLoggedProperties; // istanbul ignore next\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj['default'] = obj;\n    return newObj;\n  }\n}\n\nvar _createNewLookupObject = createNewLookupObject;\n\nvar _logger = logger$1.exports;\n\nvar logger = _interopRequireWildcard(_logger);\n\nvar loggedProperties = Object.create(null);\n\nfunction createProtoAccessControl(runtimeOptions) {\n  var defaultMethodWhiteList = Object.create(null);\n  defaultMethodWhiteList['constructor'] = false;\n  defaultMethodWhiteList['__defineGetter__'] = false;\n  defaultMethodWhiteList['__defineSetter__'] = false;\n  defaultMethodWhiteList['__lookupGetter__'] = false;\n  var defaultPropertyWhiteList = Object.create(null); // eslint-disable-next-line no-proto\n\n  defaultPropertyWhiteList['__proto__'] = false;\n  return {\n    properties: {\n      whitelist: _createNewLookupObject.createNewLookupObject(defaultPropertyWhiteList, runtimeOptions.allowedProtoProperties),\n      defaultValue: runtimeOptions.allowProtoPropertiesByDefault\n    },\n    methods: {\n      whitelist: _createNewLookupObject.createNewLookupObject(defaultMethodWhiteList, runtimeOptions.allowedProtoMethods),\n      defaultValue: runtimeOptions.allowProtoMethodsByDefault\n    }\n  };\n}\n\nfunction resultIsAllowed(result, protoAccessControl, propertyName) {\n  if (typeof result === 'function') {\n    return checkWhiteList(protoAccessControl.methods, propertyName);\n  } else {\n    return checkWhiteList(protoAccessControl.properties, propertyName);\n  }\n}\n\nfunction checkWhiteList(protoAccessControlForType, propertyName) {\n  if (protoAccessControlForType.whitelist[propertyName] !== undefined) {\n    return protoAccessControlForType.whitelist[propertyName] === true;\n  }\n\n  if (protoAccessControlForType.defaultValue !== undefined) {\n    return protoAccessControlForType.defaultValue;\n  }\n\n  logUnexpecedPropertyAccessOnce(propertyName);\n  return false;\n}\n\nfunction logUnexpecedPropertyAccessOnce(propertyName) {\n  if (loggedProperties[propertyName] !== true) {\n    loggedProperties[propertyName] = true;\n    logger.log('error', 'Handlebars: Access has been denied to resolve the property \"' + propertyName + '\" because it is not an \"own property\" of its parent.\\n' + 'You can add a runtime option to disable the check or this warning:\\n' + 'See https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details');\n  }\n}\n\nfunction resetLoggedProperties() {\n  Object.keys(loggedProperties).forEach(function (propertyName) {\n    delete loggedProperties[propertyName];\n  });\n}\n"],"names":["protoAccess","__esModule","createProtoAccessControl","resultIsAllowed","resetLoggedProperties","_interopRequireWildcard","obj","newObj","key","Object","prototype","hasOwnProperty","call","_createNewLookupObject","createNewLookupObject","_logger","logger$1","exports","logger","loggedProperties","create","runtimeOptions","defaultMethodWhiteList","defaultPropertyWhiteList","properties","whitelist","allowedProtoProperties","defaultValue","allowProtoPropertiesByDefault","methods","allowedProtoMethods","allowProtoMethodsByDefault","result","protoAccessControl","propertyName","checkWhiteList","protoAccessControlForType","undefined","logUnexpecedPropertyAccessOnce","log","keys","forEach"],"mappings":"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"}
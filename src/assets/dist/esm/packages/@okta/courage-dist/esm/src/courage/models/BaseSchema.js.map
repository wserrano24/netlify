{"version":3,"file":"BaseSchema.js","sources":["../../../../../../../../../packages/@okta/courage-dist/esm/src/courage/models/BaseSchema.js"],"sourcesContent":["import oktaUnderscore from '../util/underscore-wrapper.js';\nimport BaseCollection from './BaseCollection.js';\nimport BaseModel from './BaseModel.js';\nimport SchemaProperty from './SchemaProperty.js';\n\nconst parseProperties = function (resp) {\n  const schemaMeta = oktaUnderscore.pick(resp, 'id', 'name', 'displayName');\n\n  const properties = oktaUnderscore.map(resp.schema.properties, function (property, name) {\n    return oktaUnderscore.extend({\n      name: name\n    }, property);\n  });\n\n  oktaUnderscore.each(properties, function (property) {\n    property['__schemaMeta__'] = schemaMeta;\n\n    if (property.__metadata) {\n      property['__metadata__'] = property.__metadata;\n      delete property.__metadata;\n    }\n  });\n\n  return properties;\n};\n\nconst BaseSchemaSchema = BaseModel.extend({\n  defaults: {\n    id: undefined,\n    displayName: undefined,\n    name: undefined\n  },\n  constructor: function () {\n    this.properties = new SchemaProperty.Collection();\n    BaseModel.apply(this, arguments);\n  },\n  getProperties: function () {\n    return this.properties;\n  },\n  clone: function () {\n    const model = BaseModel.prototype.clone.apply(this, arguments);\n    model.getProperties().set(this.getProperties().toJSON({\n      verbose: true\n    }));\n    return model;\n  },\n  parse: function (resp) {\n    const properties = parseProperties(resp);\n    this.properties.set(properties, {\n      parse: true\n    });\n    return oktaUnderscore.omit(resp, 'schema');\n  },\n  trimProperty: function (property) {\n    return oktaUnderscore.omit(property, 'name');\n  },\n  toJSON: function () {\n    const json = BaseModel.prototype.toJSON.apply(this, arguments);\n    json.schema = {\n      properties: {}\n    };\n    this.getProperties().each(function (model) {\n      const property = model.toJSON();\n      json.schema.properties[property.name] = this.trimProperty(property);\n    }, this);\n    return json;\n  },\n  save: function () {\n    this.getProperties().each(function (model) {\n      model.cleanup();\n    });\n    return BaseModel.prototype.save.apply(this, arguments);\n  }\n});\nconst BaseSchemaSchemas = BaseCollection.extend({\n  model: BaseSchemaSchema\n});\nvar BaseSchema = {\n  parseProperties: parseProperties,\n  Model: BaseSchemaSchema,\n  Collection: BaseSchemaSchemas\n};\n\nexport { BaseSchema as default };\n"],"names":["parseProperties","resp","schemaMeta","oktaUnderscore","pick","properties","map","schema","property","name","extend","each","__metadata","BaseSchemaSchema","BaseModel","defaults","id","undefined","displayName","constructor","SchemaProperty","Collection","apply","arguments","getProperties","clone","model","prototype","set","toJSON","verbose","parse","omit","trimProperty","json","save","cleanup","BaseSchemaSchemas","BaseCollection","BaseSchema","Model"],"mappings":"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"}
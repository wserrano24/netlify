{"version":3,"file":"getAuthClient.js","sources":["../../../../src/widget/getAuthClient.ts"],"sourcesContent":["import { OktaAuth } from '@okta/okta-auth-js';\nimport Util from 'util/Util';\nimport config from 'config/config.json';\nimport { WidgetOptions } from 'types';\n\nexport default function(options: WidgetOptions = {}): OktaAuth {\n  // if authClient is set, authParams are disregarded\n  let { authClient, authParams } = options;\n\n  if (!authClient) {\n    // Create an authClient using widget options and optional authParams\n    const {\n      issuer,\n      clientId,\n      redirectUri,\n      state,\n      scopes,\n      flow,\n      codeChallenge,\n      codeChallengeMethod,\n      recoveryToken\n    } = options;\n    authParams = {\n      issuer,\n      clientId,\n      redirectUri,\n      state,\n      scopes,\n      flow,\n      codeChallenge,\n      codeChallengeMethod,\n      transformErrorXHR: Util.transformErrorXHR,\n      recoveryToken,\n      ...authParams\n    };\n\n    if (!authParams.issuer) {\n      authParams.issuer = options.baseUrl + '/oauth2/default';\n    }\n\n    authClient = new OktaAuth(authParams);\n  }\n\n  // Add widget version to extended user agent header\n  if (!authClient._oktaUserAgent) {\n    // TODO: this block handles OKTA UA for passed in authClient, error should be thrown in the next major version\n    // For now, do nothing here to preserve the current behavior\n    // JIRA: https://oktainc.atlassian.net/browse/OKTA-433378\n    // throw new ConfigError('The passed in authClient should be version 5.4.0 or above.');\n  } else {\n    authClient._oktaUserAgent.addEnvironment(`okta-signin-widget-${config.version}`);\n  }\n\n  return authClient;\n}\n"],"names":["options","authClient","authParams","issuer","clientId","redirectUri","state","scopes","flow","codeChallenge","codeChallengeMethod","recoveryToken","transformErrorXHR","Util","baseUrl","OktaAuth","_oktaUserAgent","addEnvironment","config","version"],"mappings":";;;;AAKe,sBAASA,EAAAA,OAAsB,GAAG,EAAlC,EAAgD;AAC7D;AACA,EAAI,IAAA;AAAEC,IAAAA,UAAU,EAAVA,UAAF;AAAcC,IAAAA,UAAU,EAAVA,UAAAA;AAAd,GAAA,GAA6BF,OAAjC,CAAA;;AAEA,EAAI,IAAA,CAACC,UAAL,EAAiB;AACf;AACA,IAAM,MAAA;AACJE,MAAAA,MAAM,EAANA,MADI;AAEJC,MAAAA,QAAQ,EAARA,QAFI;AAGJC,MAAAA,WAAW,EAAXA,WAHI;AAIJC,MAAAA,KAAK,EAALA,KAJI;AAKJC,MAAAA,MAAM,EAANA,MALI;AAMJC,MAAAA,IAAI,EAAJA,IANI;AAOJC,MAAAA,aAAa,EAAbA,aAPI;AAQJC,MAAAA,mBAAmB,EAAnBA,mBARI;AASJC,MAAAA,aAAa,EAAbA,aAAAA;AATI,KAAA,GAUFX,OAVJ,CAAA;AAWAE,IAAAA,UAAU,GAAG;AACXC,MAAAA,MAAM,EAANA,MADW;AAEXC,MAAAA,QAAQ,EAARA,QAFW;AAGXC,MAAAA,WAAW,EAAXA,WAHW;AAIXC,MAAAA,KAAK,EAALA,KAJW;AAKXC,MAAAA,MAAM,EAANA,MALW;AAMXC,MAAAA,IAAI,EAAJA,IANW;AAOXC,MAAAA,aAAa,EAAbA,aAPW;AAQXC,MAAAA,mBAAmB,EAAnBA,mBARW;AASXE,MAAAA,iBAAiB,EAAEC,IAAI,CAACD,iBATb;AAUXD,MAAAA,aAAa,EAAbA,aAVW;AAWX,MAAGT,GAAAA,UAAAA;AAXQ,KAAb,CAAA;;AAcA,IAAA,IAAI,CAACA,UAAU,CAACC,MAAhB,EAAwB;AACtBD,MAAAA,UAAU,CAACC,MAAX,GAAoBH,OAAO,CAACc,OAAR,GAAkB,iBAAtC,CAAA;AACD,KAAA;;AAEDb,IAAAA,UAAU,GAAG,IAAIc,QAAJ,CAAab,UAAb,CAAb,CAAA;AACD,GApC4D;;;AAuC7D,EAAA,IAAI,CAACD,UAAU,CAACe,cAAhB,EAAgC,CAAhC,MAKO;AACLf,IAAAA,UAAU,CAACe,cAAX,CAA0BC,cAA1B,CAA0C,CAAqBC,mBAAAA,EAAAA,MAAM,CAACC,OAAQ,CAA9E,CAAA,CAAA,CAAA;AACD,GAAA;;AAED,EAAA,OAAOlB,UAAP,CAAA;AACD;;;;"}
{"version":3,"file":"Util.js","sources":["../../../../src/util/Util.js"],"sourcesContent":["/* eslint-disable max-statements */\n/*!\n * Copyright (c) 2015-2016, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\n/* eslint complexity: [2, 13], max-depth: [2, 3] */\nimport { _, loc } from 'okta';\nimport Enums from './Enums';\nimport Logger from './Logger';\nimport BrowserFeatures from './BrowserFeatures';\n\nconst Util = {};\n\nconst buildInputForParameter = function(name, value) {\n  const input = document.createElement('input');\n\n  input.name = name;\n  input.value = decodeURIComponent(value);\n  input.type = 'hidden';\n  return input;\n};\n\nconst buildSubmitInput = function() {\n  const input = document.createElement('input');\n  input.type = 'submit';\n  return input;\n};\n\nconst buildDynamicForm = function(url = '', method) {\n  const splitOnFragment = url.split('#');\n  const fragment = splitOnFragment[1];\n  const splitOnQuery = (splitOnFragment[0] || '').split('?');\n  const query = splitOnQuery[1];\n  let targetUrl = splitOnQuery[0];\n\n  if (fragment) {\n    targetUrl += '#' + fragment;\n  }\n\n  const form = document.createElement('form');\n\n  form.method = method;\n  form.setAttribute('style', 'display: none;');\n  form.action = targetUrl;\n  if (query && query.length) {\n    const queryParts = query.split('&');\n\n    queryParts.forEach(queryPart => {\n      const parameterParts = queryPart.split('=');\n      const input = buildInputForParameter(parameterParts[0], parameterParts[1]);\n\n      form.appendChild(input);\n    });\n  }\n  form.appendChild(buildSubmitInput());\n\n  return form;\n};\n\n// eslint-disable-next-line complexity\nUtil.transformErrorXHR = function(xhr) {\n  // Handle network connection error\n  if (xhr.status === 0 && _.isEmpty(xhr.responseJSON)) {\n    xhr.responseJSON = { errorSummary: loc('error.network.connection', 'login') };\n    return xhr;\n  }\n  if (!xhr.responseJSON) {\n    if (!xhr.responseText) {\n      // Empty server response\n      xhr.responseJSON = { errorSummary: loc('error.unsupported.response', 'login') };\n      return xhr;\n    }\n    if (typeof xhr.responseText === 'string') {\n      try {\n        xhr.responseJSON = JSON.parse(xhr.responseText);\n      } catch (e) {\n        // Malformed server response\n        xhr.responseJSON = { errorSummary: loc('error.unsupported.response', 'login') };\n        return xhr;\n      }\n    } else if (typeof xhr.responseText === 'object') {\n      xhr.responseJSON = xhr.responseText;\n    } \n  }\n  // Temporary solution to display field errors\n  // Assuming there is only one field error in a response\n  if (xhr.responseJSON && xhr.responseJSON.errorCauses && xhr.responseJSON.errorCauses.length) {\n    xhr.responseJSON.errorSummary = xhr.responseJSON.errorCauses[0].errorSummary;\n  }\n  // Replace error messages\n  if (!_.isEmpty(xhr.responseJSON)) {\n    const errorMsg = loc('errors.' + xhr.responseJSON.errorCode, 'login');\n\n    if (errorMsg.indexOf('L10N_ERROR[') === -1) {\n      xhr.responseJSON.errorSummary = errorMsg;\n      if (xhr.responseJSON && xhr.responseJSON.errorCauses && xhr.responseJSON.errorCauses.length) {\n        // BaseForm will consume errorCauses before errorSummary if it is an array,\n        // so, we have to make sure to remove it when we have a valid error code\n        delete xhr.responseJSON.errorCauses;\n      }\n    }\n  }\n  return xhr;\n};\n\n// Simple helper function to lowercase all strings in the given array\nUtil.toLower = function(strings) {\n  return _.map(strings, function(str) {\n    return str.toLowerCase();\n  });\n};\n\n// A languageCode can be composed of multiple parts, i.e:\n// {{language}}-{{region}}-{{dialect}}\n//\n// In these cases, it's necessary to generate a list of other possible\n// combinations that we might support (in preferred order).\n//\n// For example:\n// en-US -> [en-US, en]\n// de-DE-bavarian -> [de-DE-bavarian, de-DE, de]\nfunction expandLanguage(language) {\n  const expanded = [language];\n  const parts = language.split('-');\n\n  while (parts.pop() && parts.length > 0) {\n    expanded.push(parts.join('-'));\n  }\n  return expanded;\n}\n\n// Following the rules of expanding one language, this will generate\n// all potential languages in the given order (where higher priority is\n// given to expanded languages over other downstream languages).\nUtil.expandLanguages = function(languages) {\n  return _.chain(languages).map(expandLanguage).flatten().uniq().value();\n};\n\n//helper to call setTimeout\nUtil.callAfterTimeout = function(callback, time) {\n  return setTimeout(callback, time);\n};\n\n// Helper function to provide consistent formatting of template literals\n// that are logged when in development mode.\nUtil.debugMessage = function(message) {\n  Logger.warn(`\\n${message.replace(/^(\\s)+/gm, '')}`);\n};\n\nUtil.logConsoleError = function(message) {\n  Logger.error(message);\n};\n\n// Trigger an afterError event\nUtil.triggerAfterError = function(controller, err = {}) {\n  if (!err.statusCode && err.xhr && err.xhr.status) {\n    // Bring the statusCode to the top-level of the Error\n    err.statusCode = err.xhr.status;\n  }\n  // Some controllers return the className as a function - process it here:\n  const className = _.isFunction(controller.className) ? controller.className() : controller.className;\n\n  const error = _.pick(err, 'name', 'message', 'statusCode', 'xhr');\n\n  controller.trigger('afterError', { controller: className }, error);\n  // Logs to console only in dev mode\n  Logger.warn('controller: ' + className + ', error: ' + error);\n};\n\nUtil.redirect = function(url, win = window, isAppLink = false) {\n  if (!url) {\n    Logger.error(`Cannot redirect to empty URL: (${url})`);\n    return;\n  }\n  if (BrowserFeatures.isAndroid() && !isAppLink) {\n    Util.redirectWithFormGet(url);\n  } else {\n    win.location.href = url;\n  }\n};\n\n/**\n * Why redirect via Form get rather using `window.location.href`?\n * At the time of writing, Chrome (<72) in Android would block window location change\n * at following case\n * 1. An AJAX is trigger because of user action.\n * 2. 5+ seconds passed without any further user interaction.\n * 3. User takes an action results in window location change.\n *\n * Luckily we discovered that uses Form submit would work around this problem\n * even though it changed window location.\n *\n * Check the commit history for more details.\n */\nUtil.redirectWithFormGet = function(url) {\n  Util.redirectWithForm(url, 'get');\n};\n\nUtil.redirectWithForm = function(url, method = 'post') {\n  if (!url) {\n    Logger.error(`Cannot redirect to empty URL: (${url})`);\n    return;\n  }\n\n  const mainContainer = document.getElementById(Enums.WIDGET_CONTAINER_ID);\n\n  if (!mainContainer) {\n    Logger.error('Cannot find okta-sign-in container append to which a form');\n    return;\n  }\n\n  const form = buildDynamicForm(url, method);\n\n  mainContainer.appendChild(form);\n  form.querySelector('input[type=\"submit\"]').click();\n};\n\n/**\n * When we want to show an explain text, we need to check if this is different from\n * the label text, to not have an explain that look like a duplicated label.\n * okta-signin-widget gives the possibility to customize every i18n, so we cannot\n * know ahead if these two are equal or different, we need to call this function everytime.\n */\nUtil.createInputExplain = function(explainKey, labelKey, bundleName, explainParams, labelParams) {\n  const explain = explainParams ? loc(explainKey, bundleName, explainParams) : loc(explainKey, bundleName);\n  const label = labelParams ? loc(labelKey, bundleName, labelParams) : loc(labelKey, bundleName);\n\n  if (explain === label) {\n    return false;\n  }\n  return explain;\n};\n\nUtil.isV1StateToken = function(token) {\n  return !!(token && _.isString(token) && token.startsWith('00'));\n};\n\nexport default Util;\n"],"names":["Util","buildInputForParameter","name","value","input","document","createElement","decodeURIComponent","type","buildSubmitInput","buildDynamicForm","url","method","splitOnFragment","split","fragment","splitOnQuery","query","targetUrl","form","setAttribute","action","length","queryParts","forEach","queryPart","parameterParts","appendChild","transformErrorXHR","xhr","status","_","isEmpty","responseJSON","errorSummary","loc","responseText","JSON","parse","e","errorCauses","errorMsg","errorCode","indexOf","toLower","strings","map","str","toLowerCase","expandLanguage","language","expanded","parts","pop","push","join","expandLanguages","languages","chain","flatten","uniq","callAfterTimeout","callback","time","setTimeout","debugMessage","message","logConsoleError","Logger","error","triggerAfterError","controller","err","statusCode","className","isFunction","pick","trigger","redirect","win","window","isAppLink","BrowserFeatures","isAndroid","redirectWithFormGet","location","href","redirectWithForm","mainContainer","getElementById","Enums","WIDGET_CONTAINER_ID","querySelector","click","createInputExplain","explainKey","labelKey","bundleName","explainParams","labelParams","explain","label","isV1StateToken","token","isString","startsWith"],"mappings":"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"}
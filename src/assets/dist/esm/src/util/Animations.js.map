{"version":3,"file":"Animations.js","sources":["../../../../src/util/Animations.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2016, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\n/* eslint max-statements: [2, 15] */\n\nimport Q from 'q';\nimport Enums from './Enums';\nconst SWAP_PAGE_TIME = 200;\nconst fn = {};\n\nfunction zoom($el, start, finish) {\n  const deferred = Q.defer();\n\n  $el.animate(\n    {\n      'text-indent': 1,\n    },\n    {\n      duration: 200,\n      easing: 'swing',\n      step: function(now, fx) {\n        fx.start = start;\n        fx.end = finish;\n        $el.css('transform', 'scale(' + now + ', ' + now + ')');\n      },\n      always: function() {\n        deferred.resolve($el);\n      },\n    }\n  );\n  return deferred.promise;\n}\n\nfunction rotate($el, start, finish) {\n  const deferred = Q.defer();\n\n  $el.animate(\n    {\n      'text-indent': 1,\n    },\n    {\n      duration: 150,\n      easing: 'swing',\n      step: function(now, fx) {\n        fx.start = start;\n        fx.end = finish;\n        $el.css('transform', 'rotate(' + now + 'deg)');\n      },\n      always: function() {\n        deferred.resolve($el);\n      },\n    }\n  );\n  return deferred.promise;\n}\n\n// Note: It is necessary to pass in a success callback because we must\n// remove the old dom node (and controller) in the same tick of the event\n// loop. Waiting for \"then\" results in a glitchy animation.\nfn.swapPages = function(options) {\n  const deferred = Q.defer();\n  const $parent = options.$parent;\n  const $oldRoot = options.$oldRoot;\n  const $newRoot = options.$newRoot;\n  const success = options.success;\n  const ctx = options.ctx;\n  let directionClassName = 'transition-from-right';\n\n  if (options.dir && options.dir === Enums.DIRECTION_BACK) {\n    directionClassName = 'transition-from-left';\n  }\n\n  $newRoot.addClass(directionClassName);\n  $parent.append($newRoot);\n\n  $parent.addClass('animation-container-overflow');\n  $newRoot.animate({ left: '0px', top: '0px', opacity: 1 }, SWAP_PAGE_TIME, function() {\n    $parent.removeClass('animation-container-overflow');\n    $newRoot.removeClass(directionClassName);\n    $newRoot.removeAttr('style');\n    success.call(ctx);\n    deferred.resolve();\n  });\n\n  $oldRoot.animate({ height: $newRoot.height(), opacity: 0 }, SWAP_PAGE_TIME * 0.8);\n\n  return deferred.promise;\n};\n\nfn.swapBeacons = function(options) {\n  const $el = options.$el;\n  const swap = options.swap;\n  const ctx = options.ctx;\n\n  return this.implode($el)\n    .then(function() {\n      swap.call(ctx);\n      return $el;\n    })\n    .then(this.explode);\n};\n\nfn.explode = function($el) {\n  return zoom($el, 0, 1); //zoom in\n};\n\nfn.implode = function($el) {\n  return zoom($el, 1, 0); //zoom out\n};\n\nfn.radialProgressBar = function(options) {\n  const radialProgressBar = options.$el;\n  const swap = options.swap;\n  const circles = radialProgressBar.children();\n\n  return rotate(circles, 0, 180)\n    .then(function() {\n      radialProgressBar.css({ clip: 'auto' });\n    })\n    .then(function() {\n      const leftHalf = circles.eq(0);\n\n      swap();\n      return rotate(leftHalf, 180, 360);\n    })\n    .then(function() {\n      //reset values to initial state\n      radialProgressBar.css({ clip: 'rect(0px, 96px, 96px, 48px)' });\n      circles.css({\n        transform: 'rotate(0deg)',\n        'text-indent': '1px',\n      });\n    });\n};\n\nexport default fn;\n"],"names":["SWAP_PAGE_TIME","fn","zoom","$el","start","finish","deferred","Q","defer","animate","duration","easing","step","now","fx","end","css","always","resolve","promise","rotate","swapPages","options","$parent","$oldRoot","$newRoot","success","ctx","directionClassName","dir","Enums","DIRECTION_BACK","addClass","append","left","top","opacity","removeClass","removeAttr","call","height","swapBeacons","swap","implode","then","explode","radialProgressBar","circles","children","clip","leftHalf","eq","transform"],"mappings":"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"}
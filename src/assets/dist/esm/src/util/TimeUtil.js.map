{"version":3,"file":"TimeUtil.js","sources":["../../../../src/util/TimeUtil.js"],"sourcesContent":["import toMilliseconds from '@sindresorhus/to-milliseconds';\nimport parseMs from 'parse-ms';\n\nconst MOMENT_UNIT = {\n  MILLISECOND: 'milliseconds',\n  SECOND: 'seconds',\n  MINUTE: 'minutes',\n  HOUR: 'hours',\n  DAY: 'days',\n};\n\nconst MOMENT_UNIT_KEYS = Object.keys(MOMENT_UNIT);\n\n/**\n * @method convertMomentUnits\n * Conversion between moment's units and our units internally\n *\n * @param {String} momentUnit The units that val is in\n * @return {String} The key in the MOMENT_UNIT hash\n */\nconst convertMomentUnits = function(momentUnit) {\n  const entry = MOMENT_UNIT_KEYS.filter(k => MOMENT_UNIT[k] === momentUnit);\n\n  return entry.length === 1 ? entry[0] : momentUnit;\n};\n\nexport default {\n  /**\n   * @method getTimeInHighestRelevantUnit\n   * Will return a number in the units of the highest relevant time unit.\n   * Only checks milliseconds, seconds, minutes, hours, and days.\n   * E.g.\n   *   15 MINUTE  -> 15 MINUTE\n   *   15 minutes -> 15 MINUTE\n   *   60 minutes ->  1 HOUR\n   *   90 minutes -> 90 MINUTE\n   *   24 HOUR    ->  1 DAY\n   *   24 hours   ->  1 DAY\n   *   30 DAY     -> 30 DAY\n   *\n   * @typedef { \"MILLISECOND\" | \"SECOND\" | \"MINUTE\" | \"HOUR\" | \"DAY\" } TimeUnit\n   *\n   * @typedef { \"MILLISECOND\" | \"SECOND\" | \"MINUTE\" | \"HOUR\" | \"DAY\" |\n   *            \"milliseconds\" | \"seconds\" | \"minutes\" | \"hours\" | \"days\"\n   *          } FlexibleTimeUnit\n   *\n   * @typedef TimeAndUnit\n   * @property {number} time the consolidated time\n   * @property {TimeUnit} unit the unit of the time\n   *\n   * @param {FlexibleTimeUnit} unit The time unit\n   * @return {TimeAndUnit} An object containing the amount of time and the unit\n   */\n  getTimeInHighestRelevantUnit: function(val, unit) {\n    const defaultTimeObj = {\n      days: 0,\n      hours: 0,\n      minutes: 0,\n      seconds: 0,\n      milliseconds: 0,\n    };\n    const normalizedUnit = MOMENT_UNIT[unit] || unit;\n    let timeObj;\n\n    try {\n      const ms = toMilliseconds(Object.assign(defaultTimeObj, { [normalizedUnit]: val }));\n      timeObj = parseMs(ms);\n    } catch (error) {\n      timeObj = {};\n    }\n\n    const duration = Object.keys(timeObj).reduce((init, k) => {\n      if (timeObj[k] !== 0) {\n        init[k] = timeObj[k];\n      }\n      return init;\n    }, {});\n\n    let highestUnit;\n    let time;\n    if (Object.keys(duration).length === 1) {\n      Object.keys(duration).forEach(k => {\n        time = duration[k];\n        highestUnit = k;\n      });\n    } else {\n      time = val;\n      highestUnit = normalizedUnit;\n    }\n\n    return {\n      time: time,\n      unit: convertMomentUnits(highestUnit),\n    };\n  },\n};\n"],"names":["MOMENT_UNIT","MILLISECOND","SECOND","MINUTE","HOUR","DAY","MOMENT_UNIT_KEYS","Object","keys","convertMomentUnits","momentUnit","entry","filter","k","length","getTimeInHighestRelevantUnit","val","unit","defaultTimeObj","days","hours","minutes","seconds","milliseconds","normalizedUnit","timeObj","ms","toMilliseconds","assign","parseMs","error","duration","reduce","init","highestUnit","time","forEach"],"mappings":"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"}
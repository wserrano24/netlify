{"version":3,"file":"ViewClassNamesFactory.js","sources":["../../../../../src/v2/ion/ViewClassNamesFactory.js"],"sourcesContent":["/* eslint complexity: [2, 25] */\nimport { AUTHENTICATOR_KEY, FORMS } from './RemediationConstants';\n\nconst FORMNAME_CLASSNAME_MAPPINGS = {\n  [FORMS.IDENTIFY]: {\n    [FORMS.IDENTIFY]: 'primary-auth',\n    [AUTHENTICATOR_KEY.PASSWORD]: 'primary-auth'\n  },\n  [FORMS.IDENTIFY_RECOVERY]: {\n    [FORMS.IDENTIFY_RECOVERY]: 'forgot-password',\n  },\n  [FORMS.ENROLL_PROFILE]: {\n    [FORMS.ENROLL_PROFILE]: 'registration',\n  },\n  [FORMS.CHALLENGE_AUTHENTICATOR]: {\n    [AUTHENTICATOR_KEY.EMAIL]: 'mfa-verify-passcode',\n    [AUTHENTICATOR_KEY.PASSWORD]: 'mfa-verify-password',\n    sms: 'mfa-verify-passcode',\n    voice: 'mfa-verify-passcode',\n    [AUTHENTICATOR_KEY.SECURITY_QUESTION]: 'mfa-verify-question',\n    [AUTHENTICATOR_KEY.WEBAUTHN]: 'mfa-verify-webauthn',\n    [AUTHENTICATOR_KEY.ON_PREM]: 'mfa-verify-totp',\n    [AUTHENTICATOR_KEY.RSA]: 'mfa-verify-totp',\n    [AUTHENTICATOR_KEY.OV]: 'mfa-verify',\n    [AUTHENTICATOR_KEY.GOOGLE_OTP]: 'mfa-verify',\n    [AUTHENTICATOR_KEY.DUO]: 'mfa-verify-duo',\n    [AUTHENTICATOR_KEY.SYMANTEC_VIP]: 'mfa-verify',\n    [AUTHENTICATOR_KEY.YUBIKEY]: 'mfa-verify',\n    [AUTHENTICATOR_KEY.CUSTOM_APP]: 'mfa-verify',\n  },\n  [FORMS.CHALLENGE_POLL]: {\n    [AUTHENTICATOR_KEY.OV]: 'mfa-verify',\n    [AUTHENTICATOR_KEY.CUSTOM_APP]: 'mfa-verify',\n  },\n  [FORMS.RESEND_PUSH]: {\n    [AUTHENTICATOR_KEY.OV]: 'mfa-verify',\n    [AUTHENTICATOR_KEY.CUSTOM_APP]: 'mfa-verify',\n  },\n  [FORMS.ENROLL_AUTHENTICATOR]: {\n    [AUTHENTICATOR_KEY.EMAIL]: 'enroll-email',\n    [AUTHENTICATOR_KEY.PASSWORD]: 'enroll-password',\n    sms: 'enroll-sms',\n    voice: 'enroll-call',\n    [AUTHENTICATOR_KEY.SECURITY_QUESTION]: 'enroll-question',\n    [AUTHENTICATOR_KEY.WEBAUTHN]: 'enroll-webauthn',\n    [AUTHENTICATOR_KEY.ON_PREM]: 'enroll-onprem',\n    [AUTHENTICATOR_KEY.RSA]: 'enroll-rsa',\n    [AUTHENTICATOR_KEY.DUO]: 'enroll-duo',\n    [AUTHENTICATOR_KEY.SYMANTEC_VIP]: 'enroll-symantec',\n    [AUTHENTICATOR_KEY.YUBIKEY]: 'enroll-yubikey',\n  },\n\n  [FORMS.SELECT_AUTHENTICATOR_ENROLL]: {\n    'select-authenticator-enroll': 'enroll-choices'\n  },\n  [FORMS.SELECT_AUTHENTICATOR_AUTHENTICATE]: {\n    [AUTHENTICATOR_KEY.PASSWORD]: 'forgot-password'\n  },\n  [FORMS.REENROLL_AUTHENTICATOR]: {\n    [AUTHENTICATOR_KEY.PASSWORD]: 'password-expired'\n  },\n\n  [FORMS.RESET_AUTHENTICATOR]: {\n    [AUTHENTICATOR_KEY.PASSWORD]: 'forgot-password'\n  },\n\n  [FORMS.CONSENT_ADMIN]: {\n    [FORMS.CONSENT_ADMIN]: 'admin-consent-required',\n  },\n\n  [FORMS.CONSENT_ENDUSER]: {\n    [FORMS.CONSENT_ENDUSER]: 'consent-required',\n  }\n};\n\nconst getV1ClassName = (formName, authenticatorKey, methodType, isPasswordRecoveryFlow) => {\n  // if password reset flow from identifier page with recoveryAuthenticator add forgot-password class\n  if (isPasswordRecoveryFlow && formName === FORMS.IDENTIFY) {\n    return 'forgot-password';\n  } else {\n    let key = formName;\n    if (authenticatorKey === AUTHENTICATOR_KEY.PHONE) {\n      // Both sms and call have same type phone\n      // currentAuthenticatorEnrollment is during verify and currentAuthenticator during enroll flows\n      key = `${methodType}`;\n    }\n    else if (authenticatorKey) {\n      key = `${authenticatorKey}`;\n    }\n\n    if (FORMNAME_CLASSNAME_MAPPINGS[formName] && FORMNAME_CLASSNAME_MAPPINGS[formName][key]) {\n      return FORMNAME_CLASSNAME_MAPPINGS[formName][key];\n    } else {\n      return null;\n    }\n  }\n};\n\nconst getClassNameMapping = (formName, authenticatorKey, methodType, isPasswordRecoveryFlow) => {\n\n  // 1. Generates V2 class name\n  // If we have a type which is authenticatorType/methodType use that to generate a V2 className\n  // Otherwise just use formName\n  let v2ClassName = formName;\n  if (authenticatorKey) {\n    v2ClassName = v2ClassName + '--' + authenticatorKey;\n  }\n\n  // 2. do a lookup for any V1 classNames and concat\n  let v1ClassName = getV1ClassName(\n    formName,\n    authenticatorKey,\n    methodType,\n    isPasswordRecoveryFlow,\n  );\n  const result = [v2ClassName];\n  if (v1ClassName) {\n    result.push(v1ClassName);\n  }\n\n  return result;\n};\n\nexport {\n  getClassNameMapping,\n  getV1ClassName\n};\n\n"],"names":["FORMNAME_CLASSNAME_MAPPINGS","FORMS","IDENTIFY","AUTHENTICATOR_KEY","PASSWORD","IDENTIFY_RECOVERY","ENROLL_PROFILE","CHALLENGE_AUTHENTICATOR","EMAIL","sms","voice","SECURITY_QUESTION","WEBAUTHN","ON_PREM","RSA","OV","GOOGLE_OTP","DUO","SYMANTEC_VIP","YUBIKEY","CUSTOM_APP","CHALLENGE_POLL","RESEND_PUSH","ENROLL_AUTHENTICATOR","SELECT_AUTHENTICATOR_ENROLL","SELECT_AUTHENTICATOR_AUTHENTICATE","REENROLL_AUTHENTICATOR","RESET_AUTHENTICATOR","CONSENT_ADMIN","CONSENT_ENDUSER","getV1ClassName","formName","authenticatorKey","methodType","isPasswordRecoveryFlow","key","PHONE","getClassNameMapping","v2ClassName","v1ClassName","result","push"],"mappings":"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"}
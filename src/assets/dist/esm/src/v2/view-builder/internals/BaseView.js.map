{"version":3,"file":"BaseView.js","sources":["../../../../../../src/v2/view-builder/internals/BaseView.js"],"sourcesContent":["import { _, View } from 'okta';\nimport BaseHeader from './BaseHeader';\nimport BaseForm from './BaseForm';\nimport BaseModel from './BaseModel';\nimport BaseFooter from './BaseFooter';\nimport hbs from 'handlebars-inline-precompile';\nimport {getClassNameMapping} from '../../ion/ViewClassNamesFactory';\n\nexport default View.extend({\n\n  Header: BaseHeader,\n\n  Body: BaseForm,\n\n  Footer: BaseFooter,\n\n  className() {\n    const appState = this.options.appState;\n\n    const formName = appState.get('currentFormName');\n    const authenticatorKey = appState.get('authenticatorKey');\n    const methodType = appState.get('authenticatorMethodType');\n    const isPasswordRecoveryFlow = appState.get('isPasswordRecoveryFlow');\n\n    const additionalClassNames = getClassNameMapping(\n      formName,\n      authenticatorKey,\n      methodType,\n      isPasswordRecoveryFlow,\n    );\n\n    const classNames = ['siw-main-view'].concat(additionalClassNames);\n    return classNames.join(' ');\n  },\n\n  template: hbs`\n    <div class=\"siw-main-header\"></div>\n    <div class=\"siw-main-body\"></div>\n    <div class=\"siw-main-footer\"></div>\n  `,\n\n  preRender() {\n    View.prototype.preRender.apply(this, arguments);\n    // Add Views\n    if (this.Header !== null) {\n      this.add(this.Header, {\n        selector: '.siw-main-header',\n        options: this.options,\n      });\n    }\n    this.renderForm();\n    this.add(this.Footer, {\n      selector : '.siw-main-footer',\n      options: this.options,\n    });\n  },\n\n  renderForm() {\n    let optionUiSchemaConfig;\n\n    if (this.form) {\n      this.form.remove();\n      optionUiSchemaConfig = this.form.model.toJSON({verbose: true});\n    }\n\n    // Create Model\n    const IonModel = this.createModelClass(\n      this.options.currentViewState,\n      optionUiSchemaConfig,\n      this.settings,\n    );\n\n    const model = new IonModel ({\n      formName: this.options.currentViewState.name,\n    });\n\n    if (!optionUiSchemaConfig) {\n      optionUiSchemaConfig = model.toJSON({verbose: true});\n    }\n\n    this.model = model;\n    this.form = this.add(this.Body, {\n      selector : '.siw-main-body',\n      options: Object.assign(\n        {},\n        this.options,\n        {\n          model,\n          optionUiSchemaConfig,\n        },\n      ),\n    }).last();\n\n    _.each(model.attributes, (value, key) => {\n      if (key.match(/sub_schema_local_[^ ]+/)) {\n        // in order to render different sub-schema\n        this.listenTo(model, `change:${key}`, () => {\n          this.renderForm();\n        });\n      }\n    });\n  },\n\n  createModelClass(currentViewState, optionUiSchemaConfig = {}) {\n    return BaseModel.create(currentViewState, optionUiSchemaConfig);\n  },\n\n});\n"],"names":["View","extend","Header","BaseHeader","Body","BaseForm","Footer","BaseFooter","className","appState","options","formName","get","authenticatorKey","methodType","isPasswordRecoveryFlow","additionalClassNames","getClassNameMapping","classNames","concat","join","template","preRender","prototype","apply","arguments","add","selector","renderForm","optionUiSchemaConfig","form","remove","model","toJSON","verbose","IonModel","createModelClass","currentViewState","settings","name","Object","assign","last","_","each","attributes","value","key","match","listenTo","BaseModel","create"],"mappings":"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"}
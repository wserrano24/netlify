{"version":3,"file":"BaseModel.js","sources":["../../../../../../src/v2/view-builder/internals/BaseModel.js"],"sourcesContent":["/*!\n * Copyright (c) 2020, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport { _, Model } from 'okta';\n\nconst convertUiSchemaFieldToProp = (uiSchemaField) => {\n  const config = Object.assign(\n    {},\n    _.chain(uiSchemaField)\n      .pick('minLength', 'maxLength', 'required', 'value')\n      .defaults({ type: 'string', required: true })\n      .value()\n  );\n\n  if (uiSchemaField.modelType) {\n    config.type = uiSchemaField.modelType;\n  }\n\n  return { [uiSchemaField.name]: config };\n};\n\nconst createPropsAndLocals = function(\n  remediation = {},\n  optionUiSchemaConfig = {},\n  props = {},\n  local = {}) {\n\n  const uiSchemas = remediation.uiSchema || [];\n\n  uiSchemas.forEach(schema => {\n    if (Array.isArray(schema.optionsUiSchemas)) {\n      let optionUiSchemaIndex;\n      let optionUiSchemaValue = {};\n\n      if (Number(schema.value) >= 0) {\n        optionUiSchemaIndex = schema.value;\n      }\n      if (optionUiSchemaConfig[schema.name]) {\n        optionUiSchemaValue = { value: optionUiSchemaConfig[schema.name] };\n        optionUiSchemaIndex = Number(optionUiSchemaValue.value);\n      }\n\n      Object.assign(\n        local,\n        convertUiSchemaFieldToProp(Object.assign({}, schema, optionUiSchemaValue)));\n\n      if (optionUiSchemaIndex) {\n        createPropsAndLocals(\n          { uiSchema: schema.optionsUiSchemas[optionUiSchemaIndex] },\n          optionUiSchemaConfig,\n          props,\n          local,\n        );\n      }\n    } else {\n      Object.assign(props, convertUiSchemaFieldToProp(schema));\n    }\n  });\n};\n\nconst create = function(remediation = {}, optionUiSchemaConfig = {}) {\n  const props = {};\n  const local = {\n    // current remediation form name\n    formName: 'string',\n    // use full page redirect instead of AJAX\n    useRedirect: 'boolean',\n  };\n  createPropsAndLocals(\n    remediation,\n    optionUiSchemaConfig,\n    props,\n    local);\n\n  const BaseModel = Model.extend({\n    props,\n    local,\n  });\n\n  return BaseModel;\n};\n\nexport default {\n  create,\n};\n"],"names":["convertUiSchemaFieldToProp","uiSchemaField","config","Object","assign","_","chain","pick","defaults","type","required","value","modelType","name","createPropsAndLocals","remediation","optionUiSchemaConfig","props","local","uiSchemas","uiSchema","forEach","schema","Array","isArray","optionsUiSchemas","optionUiSchemaIndex","optionUiSchemaValue","Number","create","formName","useRedirect","BaseModel","Model","extend"],"mappings":"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"}
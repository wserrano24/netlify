{"version":3,"file":"ChallengeAuthenticatorPhoneView.js","sources":["../../../../../../../src/v2/view-builder/views/phone/ChallengeAuthenticatorPhoneView.js"],"sourcesContent":["import { loc, createCallout } from 'okta';\nimport { BaseForm, BaseView } from '../../internals';\nimport BaseAuthenticatorView from '../../components/BaseAuthenticatorView';\nimport BaseResendView from '../shared/BaseResendView';\n\nconst ResendView = BaseResendView.extend(\n  {\n    // To be shown after a timeout\n    className: 'phone-authenticator-challenge__resend-warning hide',\n    events: {\n      'click a.resend-link': 'handleResendLink'\n    },\n\n    // Override this to change the resend action location from response\n    resendActionKey: 'currentAuthenticatorEnrollment-resend',\n\n    initialize() {\n      const resendText = (this.model.get('mode') === 'sms')\n        ? loc('oie.phone.verify.sms.resendText', 'login')\n        : loc('oie.phone.verify.call.resendText', 'login');\n      const linkText = (this.model.get('mode') === 'sms')\n        ? loc('oie.phone.verify.sms.resendLinkText', 'login')\n        : loc('oie.phone.verify.call.resendLinkText', 'login');\n      this.add(createCallout({\n        content: `${resendText}&nbsp;<a class='resend-link'>${linkText}</a>`,\n        type: 'warning',\n      }));\n    },\n\n    handleResendLink() {\n      this.options.appState.trigger('invokeAction', this.resendActionKey);\n      // Hide warning, but start a timeout again..\n      if (!this.el.classList.contains('hide')) {\n        this.el.classList.add('hide');\n      }\n      this.showCalloutAfterTimeout();\n    },\n  },\n);\n\nconst Body = BaseForm.extend(Object.assign(\n  {\n    className: 'phone-authenticator-challenge',\n\n    title() {\n      return loc('oie.phone.verify.title', 'login');\n    },\n\n    save() {\n      return loc('mfa.challenge.verify', 'login');\n    },\n\n    initialize() {\n      BaseForm.prototype.initialize.apply(this, arguments);\n      const sendText = (this.model.get('mode') === 'sms')\n        ? loc('oie.phone.verify.sms.codeSentText', 'login')\n        : loc('mfa.calling', 'login');\n      const enterCodeText = loc('oie.phone.verify.enterCodeText', 'login');\n      const carrierChargesText = loc('oie.phone.carrier.charges', 'login');\n\n      const strongClass = this.model.get('phoneNumber') !== loc('oie.phone.alternate.title', 'login') ?\n        'strong no-translate' : '';\n      // Courage doesn't support HTML, hence creating a subtitle here.\n      this.add(`<div class=\"okta-form-subtitle\" data-se=\"o-form-explain\">\n        ${sendText}&nbsp;<span class='${strongClass}'>${this.model.escape('phoneNumber')}.</span>\n        &nbsp;${enterCodeText}\n        <p>${carrierChargesText}</p>\n        </div>`, {\n        prepend: true,\n        selector: '.o-form-fieldset-container',\n      });\n    },\n\n    postRender() {\n      BaseForm.prototype.postRender.apply(this, arguments);\n      this.add(ResendView, {\n        selector: '.o-form-info-container',\n        prepend: true,\n      });\n    },\n  },\n));\n\nexport default BaseAuthenticatorView.extend({\n  Body,\n\n  createModelClass() {\n    const relatesToObject = this.options.currentViewState.relatesTo;\n    const { methods, profile } = relatesToObject?.value || {};\n    const ModelClass = BaseView.prototype.createModelClass.apply(this, arguments);\n    const local = Object.assign({\n      mode: {\n        'value': methods[0].type,\n        'type': 'string',\n      },\n      phoneNumber: {\n        'value': profile?.phoneNumber ? profile.phoneNumber : loc('oie.phone.alternate.title', 'login'),\n        'type': 'string',\n      }\n    }, ModelClass.prototype.local );\n    return ModelClass.extend({ local });\n  },\n});\n\nexport { ResendView };"],"names":["ResendView","BaseResendView","extend","className","events","resendActionKey","initialize","resendText","model","get","loc","linkText","add","createCallout","content","type","handleResendLink","options","appState","trigger","el","classList","contains","showCalloutAfterTimeout","Body","BaseForm","Object","assign","title","save","prototype","apply","arguments","sendText","enterCodeText","carrierChargesText","strongClass","escape","prepend","selector","postRender","BaseAuthenticatorView","createModelClass","relatesToObject","currentViewState","relatesTo","methods","profile","value","ModelClass","BaseView","local","mode","phoneNumber"],"mappings":"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"}
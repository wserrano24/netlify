{"version":3,"file":"DeviceEnrollmentTerminalView.js","sources":["../../../../../../../src/v2/view-builder/views/device/DeviceEnrollmentTerminalView.js"],"sourcesContent":["import { loc } from 'okta';\nimport { BaseForm, BaseView } from '../../internals';\nimport { IosAndAndroidLoopbackOdaTerminalView,\n  AndroidAppLinkWithAccountOdaTerminalView,\n  AndroidAppLinkWithoutAccountOdaTerminalView,\n  getDeviceEnrollmentContext} from '../../components/OdaOktaVerifyTerminalView';\nimport MdmOktaVerifyTerminalView from '../../components/MdmOktaVerifyTerminalView';\nimport Enums from 'util/Enums';\nimport OktaVerifyAuthenticatorHeader from '../../components/OktaVerifyAuthenticatorHeader';\nimport Link from '../../components/Link';\n\nconst BaseDeviceEnrollTerminalForm = BaseForm.extend({\n  noButtonBar: true,\n  className: 'device-enrollment-terminal',\n});\n\nconst AndroidAppLinkPreselectForm = BaseForm.extend({\n  attributes: { 'data-se': 'android-app-link-setup-options-terminal' },\n  title() {\n    return loc('enroll.title.oda.with.account', 'login');\n  },\n  initialize() {\n    BaseForm.prototype.initialize.apply(this, arguments);\n    const deviceEnrollmentContext = getDeviceEnrollmentContext(this.options.appState.get('deviceEnrollment'));\n    this.model.set('hasOVAccount', 'no');\n    this.addInput({\n      label: () => loc('enroll.subtitle.fastpass', 'login', [ deviceEnrollmentContext.orgName ]),\n      'label-top': true,\n      options: {\n        'no': loc('enroll.option.noaccount.fastpass', 'login'),\n        'yes': loc('enroll.option.account.fastpass', 'login'),\n      },\n      name: 'hasOVAccount',\n      type: 'radio',\n    });\n  },\n\n  saveForm() {\n    //remove any existing warnings or messages before saving form\n    this.$el.find('.o-form-error-container').empty();\n    this.options.appState.trigger('updateDeviceEnrollmentView', this.model.get('hasOVAccount') === 'yes');\n  }\n});\n\nconst AndroidAppLinkWithAccountOdaTerminalForm = BaseDeviceEnrollTerminalForm.extend({\n  attributes: { 'data-se': 'android-oda-app-link-with-ov-account-terminal' },\n  title() {\n    return loc('enroll.title.oda.with.account', 'login');\n  },\n  initialize() {\n    BaseDeviceEnrollTerminalForm.prototype.initialize.apply(this, arguments);\n    this.add(AndroidAppLinkWithAccountOdaTerminalView);\n  },\n});\n\nconst AndroidAppLinkWithoutAccountOdaTerminalForm = BaseDeviceEnrollTerminalForm.extend({\n  attributes: { 'data-se': 'android-oda-app-link-without-ov-account-terminal' },\n  title() {\n    return loc('enroll.title.oda.without.account', 'login');\n  },\n  initialize() {\n    BaseDeviceEnrollTerminalForm.prototype.initialize.apply(this, arguments);\n    this.add(AndroidAppLinkWithoutAccountOdaTerminalView);\n  },\n});\n\nconst IosAndAndroidLoopbackOdaTerminalForm = BaseDeviceEnrollTerminalForm.extend({\n  attributes: { 'data-se': 'loopback-terminal' },\n  title() {\n    return loc('enroll.title.oda', 'login');\n  },\n  initialize() {\n    BaseDeviceEnrollTerminalForm.prototype.initialize.apply(this, arguments);\n    this.add(IosAndAndroidLoopbackOdaTerminalView);\n  },\n});\n\nconst MdmTerminalForm = BaseDeviceEnrollTerminalForm.extend({\n  attributes: { 'data-se': 'mdm-terminal' },\n  title() {\n    return loc('enroll.title.mdm', 'login');\n  },\n  initialize() {\n    BaseDeviceEnrollTerminalForm.prototype.initialize.apply(this, arguments);\n    this.add(MdmOktaVerifyTerminalView);\n  },\n});\n\nconst AndroidAppLinkTerminalViewFooter = Link.extend({\n  postRender() {\n    this.$el.click((event) => {\n      event.preventDefault();\n      this.options.appState.trigger('switchBackToPreselect');\n    });\n  }\n});\n\nexport default BaseView.extend({\n  initialize() {\n    BaseView.prototype.initialize.apply(this, arguments);\n    this.listenTo(this.options.appState, 'updateDeviceEnrollmentView', this.handleUpdateDeviceEnrollmentView);\n    this.listenTo(this.options.appState, 'switchBackToPreselect', this.handleSwitchBackToPreselect);\n\n    const deviceEnrollmentContext = getDeviceEnrollmentContext(this.options.appState.get('deviceEnrollment'));\n    this.enrollmentType = (deviceEnrollmentContext.enrollmentType|| '').toLowerCase(); // oda/mdm\n\n    switch (this.enrollmentType) {\n    case Enums.ODA:\n      this.Header = OktaVerifyAuthenticatorHeader;\n      this.Body = deviceEnrollmentContext.isAndroidAppLink ?\n        AndroidAppLinkPreselectForm : IosAndAndroidLoopbackOdaTerminalForm;\n      break;\n    case Enums.MDM:\n      this.Body = MdmTerminalForm;\n      break;\n    }\n  },\n\n  handleUpdateDeviceEnrollmentView(withAccount) {\n    this.Body = withAccount ? AndroidAppLinkWithAccountOdaTerminalForm : AndroidAppLinkWithoutAccountOdaTerminalForm;\n    this.backLink = this.add(AndroidAppLinkTerminalViewFooter, {\n      options: {\n        name: 'back-to-preselect',\n        label: loc('oform.back', 'login'),\n      }\n    }).last();\n    this.renderForm();\n  },\n\n  handleSwitchBackToPreselect() {\n    this.Body = AndroidAppLinkPreselectForm;\n    this.backLink && this.backLink.remove();\n    this.render();\n  },\n});\n"],"names":["BaseDeviceEnrollTerminalForm","BaseForm","extend","noButtonBar","className","AndroidAppLinkPreselectForm","attributes","title","loc","initialize","prototype","apply","arguments","deviceEnrollmentContext","getDeviceEnrollmentContext","options","appState","get","model","set","addInput","label","orgName","name","type","saveForm","$el","find","empty","trigger","AndroidAppLinkWithAccountOdaTerminalForm","add","AndroidAppLinkWithAccountOdaTerminalView","AndroidAppLinkWithoutAccountOdaTerminalForm","AndroidAppLinkWithoutAccountOdaTerminalView","IosAndAndroidLoopbackOdaTerminalForm","IosAndAndroidLoopbackOdaTerminalView","MdmTerminalForm","MdmOktaVerifyTerminalView","AndroidAppLinkTerminalViewFooter","Link","postRender","click","event","preventDefault","BaseView","listenTo","handleUpdateDeviceEnrollmentView","handleSwitchBackToPreselect","enrollmentType","toLowerCase","Enums","ODA","Header","OktaVerifyAuthenticatorHeader","Body","isAndroidAppLink","MDM","withAccount","backLink","last","renderForm","remove","render"],"mappings":"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"}
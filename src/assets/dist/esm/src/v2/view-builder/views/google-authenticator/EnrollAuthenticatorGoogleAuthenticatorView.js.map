{"version":3,"file":"EnrollAuthenticatorGoogleAuthenticatorView.js","sources":["../../../../../../../src/v2/view-builder/views/google-authenticator/EnrollAuthenticatorGoogleAuthenticatorView.js"],"sourcesContent":["import { loc, View } from 'okta';\nimport hbs from 'handlebars-inline-precompile';\nimport { addCustomButton, BaseForm, BaseView } from '../../internals';\nimport BaseAuthenticatorView from '../../components/BaseAuthenticatorView';\nimport EnrollGoogleAuthenticatorBarcodeView from './EnrollGoogleAuthenticatorBarcodeView';\nimport EnrollAuthenticatorManualSetupView from './EnrollAuthenticatorManualSetupView';\n\nconst VIEW_TO_DISPLAY = 'viewToDisplay';\nconst viewToDisplayState = {\n  BARCODE: 'barcode',\n  MANUAL: 'manual',\n  ENTER_CODE: 'enterCode',\n};\n\nconst Body = BaseForm.extend({\n  title() {\n    return loc('oie.enroll.google_authenticator.setup.title', 'login');\n  },\n\n  noButtonBar: true,\n\n  className: 'oie-enroll-google-authenticator',\n\n  enterCodeSubtitle: View.extend({\n    template: hbs`\n      <div class=\"google-authenticator-setup-info-title enter-code-title\">\n      {{i18n code=\"oie.enroll.google_authenticator.enterCode.title\" bundle=\"login\"}}\n      </div>\n    `,\n  }),\n\n  getUISchema() {\n    const schema = BaseForm.prototype.getUISchema.apply(this, arguments);\n\n    const nextButton = addCustomButton({\n      className: 'google-authenticator-next',\n      title: loc('oform.next', 'login'),\n      attributes: {\n        style: 'display: block',\n      },\n      click: () => {\n        this.model.set(VIEW_TO_DISPLAY, viewToDisplayState.ENTER_CODE);\n      }\n    });\n\n    const verifyButton = addCustomButton({\n      className: 'google-authenticator-verify',\n      title: loc('oform.verify', 'login'),\n      click: () => {\n        this.$el.submit();\n      }\n    });\n\n    schema[0].showWhen = {\n      viewToDisplay: viewToDisplayState.ENTER_CODE,\n    };\n\n    // Add Enter Code Subtitle\n    schema.unshift({\n      View: this.enterCodeSubtitle,\n      selector: '.o-form-fieldset-container',\n      showWhen: {\n        viewToDisplay: viewToDisplayState.ENTER_CODE,\n      }\n    });\n\n    schema.push(\n      {\n        View: EnrollGoogleAuthenticatorBarcodeView,\n        selector: '.o-form-fieldset-container',\n        showWhen: {\n          viewToDisplay: viewToDisplayState.BARCODE,\n        }\n      }, {\n        View: EnrollAuthenticatorManualSetupView,\n        selector: '.o-form-fieldset-container',\n        showWhen: {\n          viewToDisplay: viewToDisplayState.MANUAL,\n        }\n      }, {\n        label: false,\n        className: 'shared-secret',\n        type: 'text',\n        placeholder: this.options.appState.get('currentAuthenticator').contextualData.sharedSecret,\n        disabled: true,\n        showWhen: {\n          viewToDisplay: viewToDisplayState.MANUAL,\n        }\n      },\n      {\n        View: nextButton,\n        showWhen: {\n          viewToDisplay: (val) => val === viewToDisplayState.BARCODE || val === viewToDisplayState.MANUAL,\n        }\n      },\n      {\n        View: verifyButton,\n        showWhen: {\n          viewToDisplay: (val) => val === viewToDisplayState.ENTER_CODE,\n        }\n      },\n    );\n    return schema;\n  },\n});\n\nexport default BaseAuthenticatorView.extend({\n  Body,\n  createModelClass() {\n    const ModelClass = BaseView.prototype.createModelClass.apply(this, arguments);\n    const local = Object.assign(\n      {\n        viewToDisplay: {\n          value: 'barcode',\n          type: 'string',\n          required: true,\n          values: [viewToDisplayState.BARCODE, viewToDisplayState.MANUAL, viewToDisplayState.ENTER_CODE],\n        }\n      },\n      ModelClass.prototype.local,\n    );\n    return ModelClass.extend({\n      local,\n    });\n  },\n});\n"],"names":["VIEW_TO_DISPLAY","viewToDisplayState","BARCODE","MANUAL","ENTER_CODE","Body","BaseForm","extend","title","loc","noButtonBar","className","enterCodeSubtitle","View","template","getUISchema","schema","prototype","apply","arguments","nextButton","addCustomButton","attributes","style","click","model","set","verifyButton","$el","submit","showWhen","viewToDisplay","unshift","selector","push","EnrollGoogleAuthenticatorBarcodeView","EnrollAuthenticatorManualSetupView","label","type","placeholder","options","appState","get","contextualData","sharedSecret","disabled","val","BaseAuthenticatorView","createModelClass","ModelClass","BaseView","local","Object","assign","value","required","values"],"mappings":"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"}
{"version":3,"file":"ChallengeViewUtil.js","sources":["../../../../../../src/v2/view-builder/utils/ChallengeViewUtil.js"],"sourcesContent":["/*!\n * Copyright (c) 2020, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport { loc, View, createButton, _ } from 'okta';\nimport hbs from 'handlebars-inline-precompile';\nimport Enums from 'util/Enums';\nimport Util from 'util/Util';\nimport {\n  FASTPASS_FALLBACK_SPINNER_TIMEOUT,\n  IDENTIFIER_FLOW,\n  LOOPBACK_RESPONSE_STATUS_CODE,\n  OV_UV_ENABLE_BIOMETRICS_FASTPASS_DESKTOP, \n  OV_UV_ENABLE_BIOMETRICS_FASTPASS_MOBILE,\n  REQUEST_PARAM_AUTHENTICATION_CANCEL_REASON,\n} from '../utils/Constants';\n\nexport function appendLoginHint(deviceChallengeUrl, loginHint) {\n  if (deviceChallengeUrl && loginHint) {\n    deviceChallengeUrl += '&login_hint=' + loginHint;\n  }\n\n  return deviceChallengeUrl;\n}\n\nexport function doChallenge(view, fromView) {\n  const deviceChallenge = view.getDeviceChallengePayload();\n  const loginHint = view.options?.settings?.get('identifier');\n  const HIDE_CLASS = 'hide';\n  switch (deviceChallenge.challengeMethod) {\n  case Enums.LOOPBACK_CHALLENGE:\n    view.title = loc('deviceTrust.sso.redirectText', 'login');\n    view.add(View.extend({\n      className: 'loopback-content',\n      template: hbs`<div class=\"spinner\"></div>`\n    }));\n    view.doLoopback(deviceChallenge);\n    break;\n  case Enums.CUSTOM_URI_CHALLENGE:\n    view.title = loc('customUri.title', 'login');\n    view.add(View.extend({\n      className: 'skinny-content',\n      template: hbs`\n            <p>\n              {{i18n code=\"customUri.required.content.prompt\" bundle=\"login\"}}\n            </p>\n          `,\n    }));\n    view.add(createButton({\n      className: 'ul-button button button-wide button-primary',\n      title: loc('oktaVerify.open.button', 'login'),\n      id: 'launch-ov',\n      click: () => {\n        view.doCustomURI();\n      }\n    }));\n    view.add(View.extend({\n      className: 'skinny-content',\n      template: hbs`\n          <p>\n            {{i18n code=\"customUri.required.content.download.title\" bundle=\"login\"}}\n          </p>\n          <p>\n            <a href=\"{{downloadOVLink}}\" target=\"_blank\" id=\"download-ov\" class=\"link\">\n              {{i18n code=\"customUri.required.content.download.linkText\" bundle=\"login\"}}\n            </a>\n          </p>\n          `,\n      getTemplateData() {\n        return {\n          downloadOVLink: deviceChallenge.downloadHref\n        };\n      },\n    }));\n    view.customURI = appendLoginHint(deviceChallenge.href, loginHint);\n    view.doCustomURI();\n    break;\n  case Enums.UNIVERSAL_LINK_CHALLENGE:\n    view.title = loc('universalLink.title', 'login');\n    view.add(View.extend({\n      className: 'universal-link-content',\n      template: hbs`\n            <div class=\"spinner\"></div>\n            {{i18n code=\"universalLink.content\" bundle=\"login\"}}\n          `\n    }));\n    view.add(createButton({\n      className: 'ul-button button button-wide button-primary',\n      title: loc('oktaVerify.open.button', 'login'),\n      click: () => {\n        // only window.location.href can open universal link in iOS/MacOS\n        // other methods won't do, ex, AJAX get or form get (Util.redirectWithFormGet)\n        let deviceChallengeUrl = appendLoginHint(deviceChallenge.href, loginHint);\n        Util.redirect(deviceChallengeUrl);\n      }\n    }));\n    break;\n  case Enums.APP_LINK_CHALLENGE:\n    view.title = loc('appLink.title', 'login');\n    view.add(View.extend({\n      className: 'app-link-content',\n      template: hbs`\n        <div class=\"spinner {{hideClass}}\"></div>\n        <div class=\"appLinkContent {{hideClass}}\">{{i18n code=\"appLink.content\" bundle=\"login\"}}</div>\n      `,\n      getTemplateData() {\n        return { hideClass: HIDE_CLASS };\n      },\n      postRender() {\n        if (fromView === IDENTIFIER_FLOW) {\n          this.$('.spinner').removeClass(HIDE_CLASS);\n          setTimeout(_.bind(()=> {\n            const data = { label: loc('goback', 'login') };\n            this.options.appState.trigger('updateFooterLink', data);\n            this.$('.spinner').addClass(HIDE_CLASS);\n            this.$('.appLinkContent').removeClass(HIDE_CLASS);\n          }, this), FASTPASS_FALLBACK_SPINNER_TIMEOUT);\n        } else {\n          this.$('.appLinkContent').removeClass(HIDE_CLASS);\n        }\n      },\n    }));\n    view.add(createButton({\n      className: `${HIDE_CLASS} al-button button button-wide button-primary`,\n      title: loc('oktaVerify.open.button', 'login'),\n      click: () => {\n        // only window.location.href can open app link in Android\n        // other methods won't do, ex, AJAX get or form get (Util.redirectWithFormGet)\n        let deviceChallengeUrl = appendLoginHint(deviceChallenge.href, loginHint);\n        Util.redirect(deviceChallengeUrl, window, true);\n      },\n      postRender() {\n        if (fromView === IDENTIFIER_FLOW) {\n          setTimeout(_.bind(()=> {\n            this.$el.removeClass(HIDE_CLASS);\n          }, this), FASTPASS_FALLBACK_SPINNER_TIMEOUT);\n        } else {\n          this.$el.removeClass(HIDE_CLASS);\n        }\n      }\n    }));\n    break;\n  }\n}\n\nexport function cancelPollingWithParams(appState, pollingCancelAction, cancelReason, statusCode) {\n  const actionParams = {};\n  actionParams[REQUEST_PARAM_AUTHENTICATION_CANCEL_REASON] = cancelReason;\n  actionParams[LOOPBACK_RESPONSE_STATUS_CODE] = statusCode;\n  appState.trigger('invokeAction', pollingCancelAction, actionParams);\n}\n\nexport function getBiometricsErrorOptions(error, isMessageObj) {\n  let errorSummaryKeys;\n  if (isMessageObj) {\n    errorSummaryKeys  = Object.values(error?.value[0]?.i18n);\n  } else {\n    errorSummaryKeys = error?.responseJSON?.errorSummaryKeys;\n  }\n\n  const isBiometricsRequiredMobile = errorSummaryKeys \n      && errorSummaryKeys.includes(OV_UV_ENABLE_BIOMETRICS_FASTPASS_MOBILE);\n  const isBiometricsRequiredDesktop = errorSummaryKeys \n      && errorSummaryKeys.includes(OV_UV_ENABLE_BIOMETRICS_FASTPASS_DESKTOP);\n  let options = [];\n\n  if (!isBiometricsRequiredMobile && !isBiometricsRequiredDesktop) {\n    return options;\n  }\n\n  const bulletPoints = [\n    loc('oie.authenticator.oktaverify.method.fastpass.verify.enable.biometrics.point1', 'login'),\n    loc('oie.authenticator.oktaverify.method.fastpass.verify.enable.biometrics.point2', 'login'),\n    loc('oie.authenticator.oktaverify.method.fastpass.verify.enable.biometrics.point3', 'login')\n  ];\n\n  // Add an additional bullet point for desktop devices\n  if (isBiometricsRequiredDesktop) {\n    bulletPoints.push(\n      loc('oie.authenticator.oktaverify.method.fastpass.verify.enable.biometrics.point4', 'login')\n    );\n  }\n\n  options = {\n    type: 'error',\n    className: 'okta-verify-uv-callout-content',\n    title: loc('oie.authenticator.oktaverify.method.fastpass.verify.enable.biometrics.title', 'login'),\n    subtitle: loc('oie.authenticator.oktaverify.method.fastpass.verify.enable.biometrics.description', 'login'),\n    bullets: bulletPoints,\n  };\n\n  return options;\n}\n"],"names":["appendLoginHint","deviceChallengeUrl","loginHint","doChallenge","view","fromView","deviceChallenge","getDeviceChallengePayload","options","settings","get","HIDE_CLASS","challengeMethod","Enums","LOOPBACK_CHALLENGE","title","loc","add","View","extend","className","template","doLoopback","CUSTOM_URI_CHALLENGE","createButton","id","click","doCustomURI","getTemplateData","downloadOVLink","downloadHref","customURI","href","UNIVERSAL_LINK_CHALLENGE","Util","redirect","APP_LINK_CHALLENGE","hideClass","postRender","IDENTIFIER_FLOW","$","removeClass","setTimeout","_","bind","data","label","appState","trigger","addClass","FASTPASS_FALLBACK_SPINNER_TIMEOUT","window","$el","cancelPollingWithParams","pollingCancelAction","cancelReason","statusCode","actionParams","REQUEST_PARAM_AUTHENTICATION_CANCEL_REASON","LOOPBACK_RESPONSE_STATUS_CODE","getBiometricsErrorOptions","error","isMessageObj","errorSummaryKeys","Object","values","value","i18n","responseJSON","isBiometricsRequiredMobile","includes","OV_UV_ENABLE_BIOMETRICS_FASTPASS_MOBILE","isBiometricsRequiredDesktop","OV_UV_ENABLE_BIOMETRICS_FASTPASS_DESKTOP","bulletPoints","push","type","subtitle","bullets"],"mappings":"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"}
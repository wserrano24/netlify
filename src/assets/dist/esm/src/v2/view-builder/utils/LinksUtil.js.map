{"version":3,"file":"LinksUtil.js","sources":["../../../../../../src/v2/view-builder/utils/LinksUtil.js"],"sourcesContent":["import { loc, _ } from 'okta';\nimport { ACTIONS, FORMS as RemediationForms } from '../../ion/RemediationConstants';\n\nconst { ENROLLED_PASSWORD_RECOVERY_LINK, ORG_PASSWORD_RECOVERY_LINK } = ACTIONS;\n\nconst getSwitchAuthenticatorLink = (appState) => {\n  if (appState.getRemediationAuthenticationOptions(RemediationForms.SELECT_AUTHENTICATOR_AUTHENTICATE).length > 1) {\n    return [\n      {\n        'type': 'link',\n        'label': loc('oie.verification.switch.authenticator', 'login'),\n        'name': 'switchAuthenticator',\n        'formName': RemediationForms.SELECT_AUTHENTICATOR_AUTHENTICATE,\n      }\n    ];\n  }\n\n  if (appState.getRemediationAuthenticationOptions(RemediationForms.SELECT_AUTHENTICATOR_ENROLL).length >= 1) {\n    return [\n      {\n        'type': 'link',\n        'label': loc('oie.enroll.switch.authenticator', 'login'),\n        'name': 'switchAuthenticator',\n        'formName': RemediationForms.SELECT_AUTHENTICATOR_ENROLL,\n      }\n    ];\n  }\n\n  return [];\n};\n\nconst getForgotPasswordLink = (appState, settings) => {\n  const forgotPasswordLink = {\n    'type': 'link',\n    'label': loc('forgotpassword', 'login'),\n    'name': 'forgot-password',\n  };\n\n  const customForgotPasswordHref = settings.get('helpLinks.forgotPassword');\n\n  if (customForgotPasswordHref) {\n    return [\n      Object.assign({}, {\n        'href': customForgotPasswordHref,\n        'label': loc('forgotpassword', 'login'),\n        'name': 'forgot-password',\n      }),\n    ];\n  }\n\n  // at identify page when only Org Authenticator Password may be available\n  else if (appState.getActionByPath(ORG_PASSWORD_RECOVERY_LINK)) {\n    return [\n      Object.assign({}, forgotPasswordLink, { actionPath: ORG_PASSWORD_RECOVERY_LINK })\n    ];\n  }\n\n  // at password verify page\n  else if (appState.getActionByPath(ENROLLED_PASSWORD_RECOVERY_LINK)) {\n    return [\n      Object.assign({}, forgotPasswordLink, { actionPath: ENROLLED_PASSWORD_RECOVERY_LINK })\n    ];\n  }\n\n  return [];\n};\n\nconst goBackLink = (appState) => {\n  if (appState.hasRemediationObject(RemediationForms.SELECT_AUTHENTICATOR_ENROLL)) {\n    return [\n      {\n        'type': 'link',\n        'label': loc('oie.go.back', 'login'),\n        'name': 'go-back',\n        'formName': RemediationForms.SELECT_AUTHENTICATOR_ENROLL,\n      }\n    ];\n  }\n\n  return [];\n};\n\nconst getSkipSetupLink = (appState, linkName) => {\n  if (appState.hasRemediationObject(RemediationForms.SKIP)) {\n    return [\n      {\n        'type': 'link',\n        'label': linkName ?? loc('oie.enroll.skip.setup', 'login'),\n        'name': 'skip-setup',\n        'actionPath': RemediationForms.SKIP,\n      }\n    ];\n  }\n\n  return [];\n};\n\n// When there is a 'cancel' object in remediation\nconst getSignOutLink = (settings, options = {}) => {\n  if (settings?.get('backToSignInUri')) {\n    return [\n      {\n        'label': loc('goback', 'login'),\n        'name': 'cancel',\n        'href': settings.get('backToSignInUri')\n      },\n    ];\n  }\n\n  return [\n    {\n      'actionPath': 'cancel',\n      'label': !options.label ? loc('goback', 'login') : options.label,\n      'name': 'cancel',\n      'type': 'link'\n    },\n  ];\n};\n\n// Use it to create a widget configured link in the absence of `cancel` object in remediation\nconst getBackToSignInLink = ({settings, appState}) => {\n  const link = {};\n\n  // If backToSignInLink is set, use this value for all scenarios\n  if (settings?.get('backToSignInUri')) {\n    link.href = settings.get('backToSignInUri');\n  }\n  // embedded scenarios\n  else if (settings?.get('useInteractionCodeFlow')) {\n    link.clickHandler = () => {\n      appState.trigger('restartLoginFlow');\n    };\n  }\n  // fallback for okta-hosted scenarios (backend should set signOutLink or backToSignOutLink)\n  else {\n    link.href = settings?.get('baseUrl');\n  }\n\n  return [\n    {\n      'type': 'link',\n      'label': loc('goback', 'login'),\n      'name': 'go-back',\n      ...link\n    },\n  ];\n};\n\nconst getReloadPageButtonLink = () => {\n  return [\n    {\n      'type': 'link',\n      'label': loc('oie.try.again', 'login'),\n      'name': 'try-again',\n      'href': window.location,\n      'className': 'button button-primary text-align-c'\n    },\n  ];\n};\n\nconst getSignUpLink = (appState, settings) => {\n  const signupLink = [];\n\n  if (appState.hasRemediationObject(RemediationForms.SELECT_ENROLL_PROFILE)) {\n    const signupLinkData = {\n      'type': 'link',\n      'label': loc('oie.registration.form.title', 'login'),\n      'name': 'enroll'\n    };\n    if (_.isFunction(settings.get('registration.click'))) {\n      signupLinkData.clickHandler = settings.get('registration.click');\n    } else {\n      signupLinkData.actionPath = RemediationForms.SELECT_ENROLL_PROFILE;\n    }\n    signupLink.push(signupLinkData);\n  }\n\n  return signupLink;\n};\n\nconst getFactorPageCustomLink = (appState, settings) => {\n  const factorPageCustomLink = [];\n  const formsNeedFactorPageCustomLink = [\n    RemediationForms.CHALLENGE_AUTHENTICATOR,\n    RemediationForms.SELECT_AUTHENTICATOR_AUTHENTICATE,\n    RemediationForms.CHALLENGE_POLL,\n    RemediationForms.AUTHENTICATOR_VERIFICATION_DATA,\n  ];\n\n  if (!appState.get('isPasswordRecovery') && formsNeedFactorPageCustomLink.includes(appState.get('currentFormName'))) {\n    const helpLinksFactorPageLabel = settings.get('helpLinks.factorPage.text');\n    const helpLinksFactorPageHref = settings.get('helpLinks.factorPage.href');\n\n    if (helpLinksFactorPageLabel && helpLinksFactorPageHref) {\n      factorPageCustomLink.push({\n        type: 'link',\n        label: helpLinksFactorPageLabel,\n        name: 'factorPageHelpLink',\n        href: helpLinksFactorPageHref,\n        target: '_blank',\n      });\n    }\n  }\n  return factorPageCustomLink;\n};\n\nexport {\n  getSwitchAuthenticatorLink,\n  getForgotPasswordLink,\n  goBackLink,\n  getSignUpLink,\n  getSignOutLink,\n  getBackToSignInLink,\n  getSkipSetupLink,\n  getReloadPageButtonLink,\n  getFactorPageCustomLink,\n};\n"],"names":["ENROLLED_PASSWORD_RECOVERY_LINK","ORG_PASSWORD_RECOVERY_LINK","ACTIONS","getSwitchAuthenticatorLink","appState","getRemediationAuthenticationOptions","RemediationForms","SELECT_AUTHENTICATOR_AUTHENTICATE","length","loc","SELECT_AUTHENTICATOR_ENROLL","getForgotPasswordLink","settings","forgotPasswordLink","customForgotPasswordHref","get","Object","assign","getActionByPath","actionPath","getSkipSetupLink","linkName","hasRemediationObject","SKIP","getSignOutLink","options","label","getBackToSignInLink","link","href","clickHandler","trigger","getReloadPageButtonLink","window","location","getSignUpLink","signupLink","SELECT_ENROLL_PROFILE","signupLinkData","_","isFunction","push","getFactorPageCustomLink","factorPageCustomLink","formsNeedFactorPageCustomLink","CHALLENGE_AUTHENTICATOR","CHALLENGE_POLL","AUTHENTICATOR_VERIFICATION_DATA","includes","helpLinksFactorPageLabel","helpLinksFactorPageHref","type","name","target"],"mappings":"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"}
{"version":3,"file":"FormController.js","sources":["../../../../../src/v1/util/FormController.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2016, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { _, internal, Form, createButton } from 'okta';\nimport BaseLoginModel from 'v1/models/BaseLoginModel';\nimport BaseLoginController from './BaseLoginController';\nimport FormType from './FormType';\nlet { Toolbar } = internal.views.forms.components;\nlet { FormUtil } = internal.views.forms.helpers;\nconst FormControllerSimpleForm = Form.extend({\n  layout: 'o-form-theme',\n  noCancelButton: true,\n  constructor: function(options) {\n    Form.call(this, options);\n    _.each(\n      _.result(this, 'formChildren') || [],\n      function(child) {\n        switch (child.type) {\n        case FormType.INPUT:\n          this.addInput(\n            _.extend(\n              {\n                label: false,\n                'label-top': true,\n              },\n              child.viewOptions\n            )\n          );\n          break;\n        case FormType.BUTTON:\n          this.add(createButton(_.extend({ model: this.model }, child.viewOptions)), child.addOptions);\n          FormUtil.applyShowWhen(this.last(), child.viewOptions && child.viewOptions.showWhen);\n          break;\n        case FormType.DIVIDER:\n          this.addDivider(child.viewOptions);\n          break;\n        case FormType.TOOLBAR:\n          this.add(Toolbar, { options: child.viewOptions });\n          FormUtil.applyShowWhen(this.last(), child.viewOptions && child.viewOptions.showWhen);\n          break;\n        case FormType.VIEW:\n          this.add(child.viewOptions.View, child.addOptions);\n          FormUtil.applyShowWhen(this.last(), child.viewOptions.showWhen);\n          break;\n        default:\n          throw new Error('Unrecognized child type: ' + child.type);\n        }\n      },\n      this\n    );\n  },\n});\nexport default BaseLoginController.extend({\n  constructor: function() {\n    const initialize = this.initialize;\n\n    this.initialize = function() {};\n\n    BaseLoginController.apply(this, arguments);\n\n    if (this.Model && this.Form) {\n      const Model = BaseLoginModel.extend(\n        _.extend(\n          {\n            parse: function(attributes) {\n              this.settings = attributes.settings;\n              this.appState = attributes.appState;\n              return _.omit(attributes, ['settings', 'appState']);\n            },\n          },\n          _.result(this, 'Model')\n        )\n      );\n\n      this.model = new Model(\n        {\n          settings: this.settings,\n          appState: this.options.appState,\n        },\n        { parse: true }\n      );\n      const Form = FormControllerSimpleForm.extend(_.result(this, 'Form', this));\n\n      this.form = new Form(this.toJSON());\n      this.add(this.form);\n    }\n\n    if (this.Footer) {\n      this.addFooter(this.Footer);\n    }\n\n    this.addListeners();\n    initialize.apply(this, arguments);\n  },\n\n  addFooter: function(Footer, args) {\n    this.footer = new Footer(_.extend(this.toJSON(), args || {}));\n    this.add(this.footer);\n  },\n\n  toJSON: function() {\n    const data = BaseLoginController.prototype.toJSON.apply(this, arguments);\n\n    return _.extend(_.pick(this.options, 'appState'), data);\n  },\n\n  back: function() {\n    if (this.footer && this.footer.back) {\n      this.footer.back();\n    }\n  },\n});\n"],"names":["Toolbar","internal","views","forms","components","FormUtil","helpers","FormControllerSimpleForm","Form","extend","layout","noCancelButton","constructor","options","call","_","each","result","child","type","FormType","INPUT","addInput","label","viewOptions","BUTTON","add","createButton","model","addOptions","applyShowWhen","last","showWhen","DIVIDER","addDivider","TOOLBAR","VIEW","View","Error","BaseLoginController","initialize","apply","arguments","Model","BaseLoginModel","parse","attributes","settings","appState","omit","form","toJSON","Footer","addFooter","addListeners","args","footer","data","prototype","pick","back"],"mappings":"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"}
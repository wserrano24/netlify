{"version":3,"file":"ManualSetupTotpController.js","sources":["../../../../../src/v1/controllers/ManualSetupTotpController.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2016, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { _, loc, View } from 'okta';\nimport hbs from 'handlebars-inline-precompile';\nimport FactorUtil from 'util/FactorUtil';\nimport FormController from 'v1/util/FormController';\nimport FormType from 'v1/util/FormType';\nimport RouterUtil from 'v1/util/RouterUtil';\nimport ManualSetupFooter from 'v1/views/enroll-factors/ManualSetupFooter';\nexport default FormController.extend({\n  className: 'enroll-manual-totp',\n  Model: function() {\n    return {\n      local: {\n        sharedSecret: ['string', false, this.options.appState.get('sharedSecret')],\n        __factorType__: ['string', false, this.options.factorType],\n        __provider__: ['string', false, this.options.provider],\n      },\n    };\n  },\n\n  Form: {\n    title: function() {\n      const factorName = FactorUtil.getFactorLabel(this.model.get('__provider__'), this.model.get('__factorType__'));\n\n      return loc('enroll.totp.title', 'login', [factorName]);\n    },\n    subtitle: _.partial(loc, 'enroll.totp.cannotScanBarcode', 'login'),\n    noButtonBar: true,\n    attributes: { 'data-se': 'step-manual-setup' },\n\n    formChildren: function() {\n      const instructions = this.settings.get('brandName')\n        ? loc('enroll.totp.manualSetupInstructions.specific', 'login', [this.settings.get('brandName')])\n        : loc('enroll.totp.manualSetupInstructions.generic', 'login');\n\n      return [\n        FormType.View({\n          View: View.extend({\n            className: 'secret-key-instructions',\n            attributes: { 'data-se': 'secret-key-instructions'},\n            template: hbs`\n             <section aria-live=\"assertive\">\n                <p  class=\"okta-form-subtitle o-form-explain text-align-c\">\n                  {{instructions}}\n                </p>\n                <p class=\"shared-key margin-top-10\" tabindex=0 \n                aria-label=\"{{i18n code=\"enroll.totp.sharedSecretInstructions.aria.secretKey\" bundle=\"login\"\n                arguments=\"sharedSecretKey\"}}\">{{sharedSecretKey}}</p>\n              </section>\n              `,\n            initialize: function(){\n              this.listenTo(this.model, 'change:sharedSecret', this.render);\n            },\n            getTemplateData: function() {\n              return {\n                instructions: instructions,\n                sharedSecretKey: this.model.get('sharedSecret')\n              };\n            },\n          })\n        }),\n        FormType.Toolbar({\n          noCancelButton: true,\n          save: loc('oform.next', 'login'),\n        }),\n      ];\n    },\n  },\n\n  Footer: ManualSetupFooter,\n\n  initialize: function() {\n    this.listenTo(this.form, 'save', function() {\n      const url = RouterUtil.createActivateFactorUrl(\n        this.model.get('__provider__'),\n        this.model.get('__factorType__'),\n        'activate'\n      );\n\n      this.options.appState.trigger('navigate', url);\n    });\n  },\n});\n"],"names":["FormController","extend","className","Model","local","sharedSecret","options","appState","get","__factorType__","factorType","__provider__","provider","Form","title","factorName","FactorUtil","getFactorLabel","model","loc","subtitle","_","partial","noButtonBar","attributes","formChildren","instructions","settings","FormType","View","template","initialize","listenTo","render","getTemplateData","sharedSecretKey","Toolbar","noCancelButton","save","Footer","ManualSetupFooter","form","url","RouterUtil","createActivateFactorUrl","trigger"],"mappings":"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"}
{"version":3,"file":"VerifyWebauthnController.js","sources":["../../../../../src/v1/controllers/VerifyWebauthnController.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2016, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\n/* eslint complexity:[2, 10], max-params: [2, 11] */\nimport { _, loc, View } from 'okta';\nimport hbs from 'handlebars-inline-precompile';\nimport Q from 'q';\nimport CryptoUtil from 'util/CryptoUtil';\nimport { WebauthnAbortError, WebAuthnError } from 'util/Errors';\nimport FactorUtil from 'util/FactorUtil';\nimport FormController from 'v1/util/FormController';\nimport FormType from 'v1/util/FormType';\nimport webauthn from 'util/webauthn';\nimport BrowserFeatures from 'util/BrowserFeatures';\nimport HtmlErrorMessageView from 'v1/views/mfa-verify/HtmlErrorMessageView';\nimport FooterMFA from 'v1/views/shared/FooterMFA';\n\nfunction getAllowCredentials(factors) {\n  const allowCredentials = [];\n\n  _.each(factors, function(factor) {\n    allowCredentials.push({\n      type: 'public-key',\n      id: CryptoUtil.strToBin(factor.profile.credentialId),\n    });\n  });\n  return allowCredentials;\n}\n\nexport default FormController.extend({\n  className: 'mfa-verify verify-webauthn',\n  Model: {\n    props: {\n      rememberDevice: 'boolean',\n    },\n\n    initialize: function() {\n      const rememberDevice = FactorUtil.getRememberDeviceValue(this.appState);\n\n      // set the initial value for remember device (Cannot do this while defining the\n      // local property because this.settings would not be initialized there yet).\n      this.set('rememberDevice', rememberDevice);\n      this.appState.on('factorSwitched signOut', () => {\n        if (this.webauthnAbortController) {\n          this.webauthnAbortController.abort();\n          this.webauthnAbortController = null;\n        }\n      });\n    },\n\n    save: function() {\n      this.trigger('request');\n\n      return this.doTransaction(function(transaction) {\n        let factor;\n\n        if (transaction.factorTypes) {\n          factor = _.findWhere(transaction.factorTypes, {\n            factorType: 'webauthn',\n          });\n        } else {\n          factor = _.findWhere(transaction.factors, {\n            factorType: 'webauthn',\n            provider: 'FIDO',\n          });\n        }\n\n        const self = this;\n\n        return factor.verify().then(function(transaction) {\n          let allowCredentials;\n          let challenge;\n\n          if (transaction.factors) {\n            const factors = transaction.factors;\n\n            challenge = transaction.challenge;\n            allowCredentials = getAllowCredentials(factors);\n          } else {\n            const factorData = transaction.factor;\n\n            challenge = factorData.challenge;\n            allowCredentials = getAllowCredentials([factorData]);\n          }\n          self.trigger('request');\n          // verify via browser webauthn js\n\n          const options = _.extend({}, challenge, {\n            allowCredentials: allowCredentials,\n            challenge: CryptoUtil.strToBin(challenge.challenge),\n          });\n\n          // AbortController is not supported in IE11\n          if (typeof AbortController !== 'undefined') {\n            self.webauthnAbortController = new AbortController();\n          }\n          return new Q(\n            // navigator.credentials is not supported in IE11\n            // eslint-disable-next-line compat/compat\n            navigator.credentials.get({\n              publicKey: options,\n              signal: self.webauthnAbortController && self.webauthnAbortController.signal,\n            })\n          )\n            .then(function(assertion) {\n              const rememberDevice = !!self.get('rememberDevice');\n\n              return factor.verify({\n                clientData: CryptoUtil.binToStr(assertion.response.clientDataJSON),\n                authenticatorData: CryptoUtil.binToStr(assertion.response.authenticatorData),\n                signatureData: CryptoUtil.binToStr(assertion.response.signature),\n                rememberDevice: rememberDevice,\n              });\n            })\n            .catch(function(error) {\n              self.trigger('errors:clear');\n              // Do not display if it is abort error triggered by code when switching.\n              // self.webauthnAbortController would be null if abort was triggered by code.\n              if (!self.webauthnAbortController) {\n                throw new WebauthnAbortError();\n              } else {\n                throw new WebAuthnError({\n                  xhr: { responseJSON: { errorSummary: error.message } },\n                });\n              }\n            })\n            .finally(function() {\n              // unset webauthnAbortController on successful authentication or error\n              self.webauthnAbortController = null;\n            });\n        });\n      });\n    },\n  },\n\n  Form: {\n    autoSave: true,\n    hasSavingState: false,\n    title: _.partial(loc, 'factor.webauthn.biometric', 'login'),\n    className: 'verify-webauthn-form',\n    noCancelButton: true,\n    save: _.partial(loc, 'mfa.challenge.verify', 'login'),\n    noButtonBar: function() {\n      return !webauthn.isNewApiAvailable();\n    },\n    modelEvents: {\n      request: '_startEnrollment',\n      error: '_stopEnrollment',\n    },\n\n    formChildren: function() {\n      const children = [];\n\n      if (webauthn.isNewApiAvailable()) {\n        children.push(\n          FormType.View({\n            View: View.extend({\n              template: hbs(\n                '<div class=\"webauthn-verify-text\">\\\n                 <p>{{i18n code=\"verify.webauthn.biometric.instructions\" bundle=\"login\"}}</p>\\\n                 <div data-se=\"webauthn-waiting\" class=\"okta-waiting-spinner\"></div>\\\n               </div>'\n              ),\n            }),\n          })\n        );\n      } else {\n        let errorMessageKey = 'webauthn.biometric.error.factorNotSupported';\n\n        if (this.options.appState.get('factors').length === 1) {\n          errorMessageKey = 'webauthn.biometric.error.factorNotSupported.oneFactor';\n        }\n        children.push(\n          FormType.View(\n            { View: new HtmlErrorMessageView({ message: loc(errorMessageKey, 'login') }) },\n            { selector: '.o-form-error-container' }\n          )\n        );\n      }\n\n      if (this.options.appState.get('allowRememberDevice')) {\n        children.push(\n          FormType.Input({\n            label: false,\n            'label-top': true,\n            placeholder: this.options.appState.get('rememberDeviceLabel'),\n            className: 'margin-btm-0',\n            name: 'rememberDevice',\n            type: 'checkbox',\n          })\n        );\n      }\n\n      return children;\n    },\n\n    _startEnrollment: function() {\n      this.$('.okta-waiting-spinner').show();\n      this.$('.o-form-button-bar').hide();\n    },\n\n    _stopEnrollment: function() {\n      this.$('.okta-waiting-spinner').hide();\n      this.$('.o-form-button-bar [type=\"submit\"]')[0].value = loc('verify.u2f.retry', 'login');\n      this.$('.o-form-button-bar').show();\n    },\n  },\n\n  postRender: function() {\n    _.defer(() => {\n      // Trigger browser prompt automatically for other browsers for better UX.\n      if (webauthn.isNewApiAvailable() && !BrowserFeatures.isSafari()) {\n        this.model.save();\n      }\n    });\n  },\n\n  back: function() {\n    // Empty function on verify controllers to prevent users\n    // from navigating back during 'verify' using the browser's\n    // back button. The URL will still change, but the view will not\n    // More details in OKTA-135060.\n  },\n\n  Footer: FooterMFA,\n});\n"],"names":["getAllowCredentials","factors","allowCredentials","_","each","factor","push","type","id","CryptoUtil","strToBin","profile","credentialId","FormController","extend","className","Model","props","rememberDevice","initialize","FactorUtil","getRememberDeviceValue","appState","set","on","webauthnAbortController","abort","save","trigger","doTransaction","transaction","factorTypes","findWhere","factorType","provider","self","verify","then","challenge","factorData","options","AbortController","Q","navigator","credentials","get","publicKey","signal","assertion","clientData","binToStr","response","clientDataJSON","authenticatorData","signatureData","signature","catch","error","WebauthnAbortError","WebAuthnError","xhr","responseJSON","errorSummary","message","finally","Form","autoSave","hasSavingState","title","partial","loc","noCancelButton","noButtonBar","webauthn","isNewApiAvailable","modelEvents","request","formChildren","children","FormType","View","template","errorMessageKey","length","HtmlErrorMessageView","selector","Input","label","placeholder","name","_startEnrollment","$","show","hide","_stopEnrollment","value","postRender","defer","BrowserFeatures","isSafari","model","back","Footer","FooterMFA"],"mappings":"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"}
{"version":3,"file":"CustomButtons.js","sources":["../../../../../../src/v1/views/primary-auth/CustomButtons.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2016, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { _, $, View, loc, createButton, internal } from 'okta';\nimport hbs from 'handlebars-inline-precompile';\nimport OAuth2Util from 'util/OAuth2Util';\nconst SharedUtil = internal.util.Util;\nconst dividerTpl = hbs('<div class=\"auth-divider\">\\\n      <span class=\"auth-divider-text\">{{text}}</span>\\\n    </div>');\nconst formTitleTpl = hbs('<h2 data-se=\"o-form-head\" class=\"okta-form-title o-form-head\">{{title}}</h2>');\nexport default View.extend({\n  className: 'primary-auth-container',\n\n  children: function() {\n    const children = [];\n    const socialIdpButtons = this.settings.get('configuredSocialIdps');\n    const pivButton = this.settings.get('piv');\n    const customButtons = this.settings.get('customButtons');\n    const divider = dividerTpl({ text: loc('socialauth.divider.text', 'login') });\n\n    if (this.settings.get('hasPivCard')) {\n      children.push(this._createPivButton(pivButton));\n    }\n\n    _.each(\n      socialIdpButtons,\n      function(button) {\n        children.push(this._createSocialIdpButton(button));\n      },\n      this\n    );\n\n    _.each(\n      customButtons,\n      function(button) {\n        children.push(this._createCustomButton(button));\n      },\n      this\n    );\n\n    // If the social auth buttons have to be above the Okta form, the title moves from\n    // primary auth form to the social auth (above the buttons) and the divider goes below\n    // the buttons (in between social auth and primary auth). If social auth needs to go below\n    // Okta form, just add the divider at the top of the social auth container. The title still\n    // lives in primary auth form.\n    if (this.settings.get('socialAuthPositionTop')) {\n      children.unshift(formTitleTpl({ title: loc('primaryauth.title', 'login') }));\n      // Divider between Primary Auth and the Social Auth\n      children.push(divider);\n    } else {\n      children.unshift(divider);\n    }\n\n    return children;\n  },\n\n  _createSocialIdpButton: function(options) {\n    return createButton({\n      attributes: {\n        'data-se': options.dataAttr,\n      },\n      className: options.className,\n      title: function() {\n        return options.text || loc(options.i18nKey);\n      },\n      click: function(e) {\n        e.preventDefault();\n        if (this.settings.get('oauth2Enabled')) {\n          OAuth2Util.getTokens(this.settings, { idp: options.id }, this.options.currentController);\n        } else {\n          const baseUrl = this.settings.get('baseUrl');\n          let params;\n          const lastAuthResponse = this.options.appState.get('lastAuthResponse');\n          if (this.options.appState.get('usingDeviceFlow')) {\n            params = $.param({\n              stateToken: lastAuthResponse?.stateToken,\n            });\n          } else {\n            params = $.param({\n              fromURI: this.settings.get('relayState'),\n            });\n          }\n          const targetUri = `${baseUrl}/sso/idps/${options.id}?${params}`;\n          SharedUtil.redirect(targetUri);\n        }\n      },\n    });\n  },\n\n  _createPivButton: function(options) {\n    let className = options.className || '';\n    return createButton({\n      attributes: {\n        'data-se': 'piv-card-button',\n      },\n      className: className + ' piv-button',\n      title: options.text || loc('piv.cac.card', 'login'),\n      click: function(e) {\n        e.preventDefault();\n        this.options.appState.trigger('navigate', 'signin/verify/piv');\n      },\n    });\n  },\n\n  _createCustomButton: function(options) {\n    return createButton({\n      attributes: {\n        'data-se': options.dataAttr,\n      },\n      className: options.className + ' default-custom-button',\n      title: function() {\n        return options.title || loc(options.i18nKey);\n      },\n      click: options.click,\n    });\n  },\n});\n"],"names":["SharedUtil","internal","util","Util","dividerTpl","formTitleTpl","View","extend","className","children","socialIdpButtons","settings","get","pivButton","customButtons","divider","text","loc","push","_createPivButton","_","each","button","_createSocialIdpButton","_createCustomButton","unshift","title","options","createButton","attributes","dataAttr","i18nKey","click","e","preventDefault","OAuth2Util","getTokens","idp","id","currentController","baseUrl","params","lastAuthResponse","appState","$","param","stateToken","fromURI","targetUri","redirect","trigger"],"mappings":"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"}
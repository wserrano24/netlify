{"version":3,"file":"EmailMagicLinkForm.js","sources":["../../../../../../src/v1/views/factor-verify/EmailMagicLinkForm.js"],"sourcesContent":["/*!\n * Copyright (c) 2019, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n/* eslint complexity: [2, 7] */\nimport { Form, createButton, loc } from 'okta';\nimport Q from 'q';\nimport Enums from 'util/Enums';\nexport default Form.extend({\n  layout: 'o-form-theme',\n  className: 'factor-verify-magiclink',\n  autoSave: true,\n  noCancelButton: true,\n  initialize: function() {\n    const form = this;\n    // for FACTOR_REQUIRED with email magic link we dont need to show otp code input field and verify button\n\n    this.title = this.model.get('factorLabel');\n    //TODO: OKTA-211618 Temp fix for demo. FACTOR_REQUIRED after sign up is missing the profile object in API response\n\n    const email = this.model.get('email') || this.options.appState.get('lastAuthResponse')._embedded.user.profile.login;\n\n    this.subtitle = '(' + email + ')';\n    this.add(\n      createButton({\n        attributes: { 'data-se': 'email-send-code' },\n        className: 'button email-request-button',\n        title: loc('mfa.sendEmail', 'login'),\n        click: function() {\n          form.clearErrors();\n          this.disable();\n          this.options.title = loc('mfa.sent', 'login');\n          this.render();\n          this.model\n            .save()\n            .then(() => {\n              return Q.delay(Enums.API_RATE_LIMIT);\n            })\n            .then(() => {\n              this.options.title = loc('mfa.resendEmail', 'login');\n              this.enable();\n              this.render();\n            });\n        },\n      })\n    );\n  },\n});\n"],"names":["Form","extend","layout","className","autoSave","noCancelButton","initialize","form","title","model","get","email","options","appState","_embedded","user","profile","login","subtitle","add","createButton","attributes","loc","click","clearErrors","disable","render","save","then","Q","delay","Enums","API_RATE_LIMIT","enable"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA,yBAAeA,IAAI,CAACC,MAAL,CAAY;AACzBC,EAAAA,MAAM,EAAE,cADiB;AAEzBC,EAAAA,SAAS,EAAE,yBAFc;AAGzBC,EAAAA,QAAQ,EAAE,IAHe;AAIzBC,EAAAA,cAAc,EAAE,IAJS;AAKzBC,EAAAA,UAAU,EAAE,YAAW;AACrB,IAAA,MAAMC,IAAI,GAAG,IAAb,CADqB;;AAIrB,IAAKC,IAAAA,CAAAA,KAAL,GAAa,IAAA,CAAKC,KAAL,CAAWC,GAAX,CAAe,aAAf,CAAb,CAJqB;;AAOrB,IAAMC,MAAAA,KAAK,GAAG,IAAA,CAAKF,KAAL,CAAWC,GAAX,CAAe,OAAf,CAA2B,IAAA,IAAA,CAAKE,OAAL,CAAaC,QAAb,CAAsBH,GAAtB,CAA0B,kBAA1B,CAA8CI,CAAAA,SAA9C,CAAwDC,IAAxD,CAA6DC,OAA7D,CAAqEC,KAA9G,CAAA;;AAEA,IAAA,IAAA,CAAKC,QAAL,GAAgB,GAAMP,GAAAA,KAAN,GAAc,GAA9B,CAAA;AACA,IAAKQ,IAAAA,CAAAA,GAAL,CACEC,YAAY,CAAC;AACXC,MAAAA,UAAU,EAAE;AAAE,QAAW,SAAA,EAAA,iBAAA;AAAb,OADD;AAEXlB,MAAAA,SAAS,EAAE,6BAFA;AAGXK,MAAAA,KAAK,EAAEc,GAAG,CAAC,eAAD,EAAkB,OAAlB,CAHC;AAIXC,MAAAA,KAAK,EAAE,YAAW;AAChBhB,QAAAA,IAAI,CAACiB,WAAL,EAAA,CAAA;AACA,QAAA,IAAA,CAAKC,OAAL,EAAA,CAAA;AACA,QAAKb,IAAAA,CAAAA,OAAL,CAAaJ,KAAb,GAAqBc,GAAG,CAAC,UAAD,EAAa,OAAb,CAAxB,CAAA;AACA,QAAA,IAAA,CAAKI,MAAL,EAAA,CAAA;AACA,QAAA,IAAA,CAAKjB,KAAL,CACGkB,IADH,EAEGC,CAAAA,IAFH,CAEQ,MAAM;AACV,UAAA,OAAOC,CAAC,CAACC,KAAF,CAAQC,KAAK,CAACC,cAAd,CAAP,CAAA;AACD,SAJH,CAAA,CAKGJ,IALH,CAKQ,MAAM;AACV,UAAKhB,IAAAA,CAAAA,OAAL,CAAaJ,KAAb,GAAqBc,GAAG,CAAC,iBAAD,EAAoB,OAApB,CAAxB,CAAA;AACA,UAAA,IAAA,CAAKW,MAAL,EAAA,CAAA;AACA,UAAA,IAAA,CAAKP,MAAL,EAAA,CAAA;AACD,SATH,CAAA,CAAA;AAUD,OAAA;AAnBU,KAAD,CADd,CAAA,CAAA;AAuBD,GAAA;AAtCwB,CAAZ,CAAf;;;;"}
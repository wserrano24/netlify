{"version":3,"file":"ScopeList.js","sources":["../../../../../../src/v1/views/admin-consent/ScopeList.js"],"sourcesContent":["/*!\n * Copyright (c) 2017, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n/* eslint max-len: [2, 131] */\nimport hbs from 'handlebars-inline-precompile';\nimport { _, View, loc } from 'okta';\nimport ScopeItem from './ScopeItem';\n\nconst SCOPE_N_GROUP_CONFIG = {\n  groups: 'user',\n  myAccount: 'user',\n  users: 'user',\n  apps: 'resource',\n  authenticators: 'resource',\n  authorizationServers: 'resource',\n  clients: 'resource',\n  domains: 'resource',\n  factors: 'resource',\n  idps: 'resource',\n  linkedObjects: 'resource',\n  policies: 'resource',\n  templates: 'resource',\n  eventHooks: 'hook',\n  inlineHooks: 'hook',\n  events: 'system',\n  logs: 'system',\n  orgs: 'system',\n  roles: 'system',\n  schemas: 'system',\n  sessions: 'system',\n  trustedOrigins: 'system',\n};\n\nconst DEFAULT_GROUP = 'system';\n\nconst findScopeGroupKey = ({ name = '' }) => {\n  const xs = name.split('.');\n  const groupType = xs[1];\n\n  return SCOPE_N_GROUP_CONFIG[groupType] || DEFAULT_GROUP;\n};\n\nconst ScopeGroupHeaderView = View.extend({\n  className: 'scope-group',\n\n  events: {\n    'click': 'expandScopes',\n  },\n\n  template: hbs`\n    <div class=\"scope-group--header\">\n    <h3>{{groupName}}</h3>\n    <span class=\"scope-group--toggle\">\n      <svg class=\"caret\"\n           width=\"12\" height=\"12\"\n           viewBox=\"0 0 12 12\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path class=\"path\" fill-rule=\"evenodd\"\n              clip-rule=\"evenodd\"\n              d=\"M5.99967 4.66663L10.2663 8.66663L11.333 7.66663L5.99967 2.66663L0.666342 7.73636L1.73301 8.66663L5.99967 4.66663Z\"\n              fill=\"#A0A7AC\">\n        </path>\n      </svg>\n    </span>\n    </div>`,\n\n  expandScopes() {\n    this.$el.toggleClass('scope-group--is-expanded');\n    this.$('.caret').toggleClass('caret--is-rotated');\n  },\n\n  preRender() {\n    _.chain(this.options.scopes)\n      .sortBy(({ name }) => name)\n      .each(({ name, displayName, description }) => {\n        this.add(ScopeItem, {\n          options: {\n            name: displayName || name,\n            description,\n          },\n        });\n      });\n  }\n});\n\nexport default View.extend({\n  className: 'scope-list detail-row',\n\n  postRender: function() {\n    const allScopes = this.model.get('scopes');\n    const scopesWithGroup = _.groupBy(allScopes, findScopeGroupKey);\n\n    const SCOPE_GROUP_NAMES_CONFIG = {\n      'user': loc('admin.consent.group.user.group', 'login'),\n      'resource': loc('admin.consent.group.resource.policy', 'login'),\n      'hook': loc('admin.consent.group.hook', 'login'),\n      'system': loc('admin.consent.group.system', 'login'),\n    };\n\n    // loop through SCOPE_GROUP_NAMES_CONFIG to keep group order consistent in UI.\n    _.each(SCOPE_GROUP_NAMES_CONFIG, (groupName, groupKey) => {\n      const scopes = scopesWithGroup[groupKey];\n      if (!Array.isArray(scopes)) {\n        return;\n      }\n      // add scope group header and scopes\n      this.add(ScopeGroupHeaderView, {\n        options: {\n          groupName,\n          scopes,\n        }\n      });\n    });\n  },\n});\n"],"names":["SCOPE_N_GROUP_CONFIG","groups","myAccount","users","apps","authenticators","authorizationServers","clients","domains","factors","idps","linkedObjects","policies","templates","eventHooks","inlineHooks","events","logs","orgs","roles","schemas","sessions","trustedOrigins","DEFAULT_GROUP","findScopeGroupKey","name","xs","split","groupType","ScopeGroupHeaderView","View","extend","className","template","expandScopes","$el","toggleClass","$","preRender","_","chain","options","scopes","sortBy","each","displayName","description","add","ScopeItem","postRender","allScopes","model","get","scopesWithGroup","groupBy","SCOPE_GROUP_NAMES_CONFIG","loc","groupName","groupKey","Array","isArray"],"mappings":"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"}